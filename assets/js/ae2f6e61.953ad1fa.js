"use strict";(globalThis.webpackChunkrouted=globalThis.webpackChunkrouted||[]).push([[4242],{5148:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"test-client/schema-validation","title":"Schema Validation","description":"Learn how to validate JSON schemas in tests","source":"@site/docs/server-testing/test-client/schema-validation.mdx","sourceDirName":"test-client","slug":"/test-client/schema-validation","permalink":"/docs/server_testing/test-client/schema-validation","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/server-testing/test-client/schema-validation.mdx","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Schema Validation","description":"Learn how to validate JSON schemas in tests","sidebar_position":6},"sidebar":"serverTestingSidebar","previous":{"title":"JSON Assertions","permalink":"/docs/server_testing/test-client/json-assertions"},"next":{"title":"Numeric Assertions","permalink":"/docs/server_testing/test-client/numeric-assertions"}}');var a=i(4848),s=i(8453);const r={title:"Schema Validation",description:"Learn how to validate JSON schemas in tests",sidebar_position:6},o="Schema Validation",l={},d=[{value:"Basic Schema Validation",id:"basic-schema-validation",level:2},{value:"Array Structure Validation",id:"array-structure-validation",level:2},{value:"Optional Fields",id:"optional-fields",level:2},{value:"Type Validation",id:"type-validation",level:2},{value:"Custom Validation",id:"custom-validation",level:2},{value:"Combining Validations",id:"combining-validations",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"schema-validation",children:"Schema Validation"})}),"\n",(0,a.jsx)(n.p,{children:"server_testing provides powerful schema validation capabilities through AssertableJson."}),"\n",(0,a.jsx)(n.h2,{id:"basic-schema-validation",children:"Basic Schema Validation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"response.assertJson((json) {\n  json.matchesSchema({\n    // Basic types\n    'id': int,\n    'name': String,\n    'active': bool,\n    'score': double,\n    \n    // Nested objects\n    'profile': {\n      'email': String,\n      'age': int,\n      'preferences': Map<String, dynamic>\n    },\n    \n    // Arrays\n    'tags': List<String>,\n    'scores': List<int>,\n    'records': List<Map<String, dynamic>>\n  });\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"array-structure-validation",children:"Array Structure Validation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"response.assertJson((json) {\n  // Validate array item structure\n  json.assertStructure({\n    'users': {\n      '*': [  // Wildcard matches all array items\n        'id',\n        'name',\n        'email'\n      ]\n    },\n    \n    // Nested arrays\n    'departments': {\n      '*': {  // Each department\n        'name': String,\n        'employees': {\n          '*': [  // Each employee\n            'id',\n            'role'\n          ]\n        }\n      }\n    }\n  });\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"optional-fields",children:"Optional Fields"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"response.assertJson((json) {\n  json.matchesSchema({\n    // Required fields\n    'id': int,\n    'name': String,\n    \n    // Optional fields (nullable)\n    'description?': String,\n    'metadata?': Map<String, dynamic>,\n    \n    // Nested optional fields\n    'profile': {\n      'email': String,\n      'phone?': String,\n      'address?': {\n        'street': String,\n        'city': String\n      }\n    }\n  });\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"type-validation",children:"Type Validation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"response.assertJson((json) {\n  json\n    // Direct type checks\n    .whereType<int>('id')\n    .whereType<String>('name')\n    .whereType<bool>('active')\n    .whereType<List>('items')\n    .whereType<Map>('metadata')\n    \n    // Nested type checks\n    .scope('user', (user) {\n      user\n        .whereType<String>('email')\n        .whereType<int>('age')\n        .scope('settings', (settings) {\n          settings.whereType<bool>('notifications');\n        });\n    });\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"custom-validation",children:"Custom Validation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"response.assertJson((json) {\n  json\n    // Custom validation function\n    .where('email', (value) {\n      return RegExp(r'^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$')\n        .hasMatch(value as String);\n    })\n    \n    // Custom type validation\n    .where('date', (value) {\n      return DateTime.tryParse(value as String) != null;\n    })\n    \n    // Complex validation\n    .where('permissions', (value) {\n      final perms = value as List;\n      return perms.every((p) => \n        p is String && ['read', 'write', 'admin'].contains(p));\n    });\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"combining-validations",children:"Combining Validations"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"response.assertJson((json) {\n  json\n    // Schema validation\n    .matchesSchema({\n      'user': {\n        'id': int,\n        'name': String,\n        'email': String\n      }\n    })\n    \n    // Additional type checks\n    .whereType<int>('user.id')\n    \n    // Value validation\n    .where('user.id', (id) => id > 0)\n    \n    // Nested validation\n    .scope('user', (user) {\n      user\n        .has('id')\n        .has('name')\n        .has('email')\n        .whereType<String>('email')\n        .where('email', (email) => \n          email.toString().contains('@'));\n    });\n});\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>o});var t=i(6540);const a={},s=t.createContext(a);function r(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);