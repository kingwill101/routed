"use strict";(self.webpackChunkrouted=self.webpackChunkrouted||[]).push([[5145],{7137:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"property-testing/generators","title":"Core Generators","description":"Generators are the heart of property-based testing. They produce values alongside the strategy for shrinking them toward simpler counterexamples. Every generator implements Generator and returns a ShrinkableValue from generate(Random random).","source":"@site/docs/property-testing/generators.mdx","sourceDirName":"property-testing","slug":"/property-testing/generators","permalink":"/docs/property-testing/generators","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/property-testing/generators.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Core Generators","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Getting Started","permalink":"/docs/property-testing/getting-started"},"next":{"title":"Specialized Generators","permalink":"/docs/property-testing/specialized-generators"}}');var s=r(4848),i=r(8453);const a={title:"Core Generators",sidebar_position:3},o=void 0,l={},c=[{value:"Composing generators fluently",id:"composing-generators-fluently",level:2},{value:"The <code>Gen</code> convenience factory",id:"the-gen-convenience-factory",level:2},{value:"Lifting generators into richer structures",id:"lifting-generators-into-richer-structures",level:2},{value:"Implementing custom generators",id:"implementing-custom-generators",level:2}];function d(e){const n={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["Generators are the heart of property-based testing. They produce values alongside the strategy for shrinking them toward simpler counterexamples. Every generator implements ",(0,s.jsx)(n.code,{children:"Generator<T>"})," and returns a ",(0,s.jsx)(n.code,{children:"ShrinkableValue<T>"})," from ",(0,s.jsx)(n.code,{children:"generate(Random random)"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"composing-generators-fluently",children:"Composing generators fluently"}),"\n",(0,s.jsxs)(n.p,{children:["The base ",(0,s.jsx)(n.code,{children:"Generator<T>"})," API provides functional combinators so you can build complex shapes out of primitives:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"map"})," transforms values while reusing the source shrinking strategy."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"flatMap"})," (a.k.a. ",(0,s.jsx)(n.code,{children:"bind"}),") switches to another generator based on a previously generated value."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"where"})," filters out values that do not meet a predicate."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"list({minLength, maxLength})"})," lifts any generator into a list generator with element-wise shrinking."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"final zipcodeGen = Gen.integer(min: 0, max: 99999)\n    .map((n) => n.toString().padLeft(5, '0'));\n\nfinal usAddressGen = zipcodeGen.flatMap((zip) {\n  return Gen.string(minLength: 4, maxLength: 24).map((street) {\n    return {'street': street, 'zip': zip};\n  });\n}).where((address) => address['street']!.trim().isNotEmpty);\n"})}),"\n",(0,s.jsx)(n.p,{children:"When a property fails, the runner walks the shrink tree provided by each generator (lists shrink by removing elements first, then shrinking individual items, etc.) until the minimal counterexample is found."}),"\n",(0,s.jsxs)(n.h2,{id:"the-gen-convenience-factory",children:["The ",(0,s.jsx)(n.code,{children:"Gen"})," convenience factory"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Gen"})," exposes a curated catalogue of primitive factories. Combine them freely or feed them into other combinators such as ",(0,s.jsx)(n.code,{children:"flatMap"})," or ",(0,s.jsx)(n.code,{children:"list"}),"."]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Generator"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Gen.integer({min, max})"})}),(0,s.jsxs)(n.td,{children:["Inclusive integer range (defaults ",(0,s.jsx)(n.code,{children:"-1000..1000"}),") with progressive shrinking toward 0/bounds."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Gen.double_({min, max})"})}),(0,s.jsxs)(n.td,{children:["Floating-point range (defaults ",(0,s.jsx)(n.code,{children:"-1000.0..1000.0"}),") that shrinks toward 0 and common boundary values."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Gen.boolean()"})}),(0,s.jsxs)(n.td,{children:["Booleans that shrink ",(0,s.jsx)(n.code,{children:"true \u2192 false"}),"."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Gen.string({minLength, maxLength})"})}),(0,s.jsx)(n.td,{children:"Alphanumeric strings with character-removal and character-simplification shrinking."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Gen.constant(value)"})}),(0,s.jsxs)(n.td,{children:["Always yields the provided value. Useful in ",(0,s.jsx)(n.code,{children:"oneOf"})," mixes."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Gen.oneOf(values)"})}),(0,s.jsx)(n.td,{children:"Picks from a list of literal values, shrinking toward earlier entries."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Gen.oneOfGen(generators)"})}),(0,s.jsx)(n.td,{children:"Picks from several generator strategies. Shrinking tries earlier generators first, then shrinks the chosen value."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Gen.frequency([(weight, generator), ...])"})}),(0,s.jsx)(n.td,{children:"Weighted choice between generators."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Gen.containerOf(elementGen, factory, {minLength, maxLength})"})}),(0,s.jsx)(n.td,{children:"Builds custom collections (set, map, queue\u2026) by passing generated elements through a factory."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Gen.pick(n, options)"})}),(0,s.jsxs)(n.td,{children:["Chooses exactly ",(0,s.jsx)(n.code,{children:"n"})," distinct values (unordered) from a list."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Gen.someOf(options, {min, max})"})}),(0,s.jsxs)(n.td,{children:["Chooses between ",(0,s.jsx)(n.code,{children:"min..max"})," distinct values."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Gen.atLeastOne(options)"})}),(0,s.jsxs)(n.td,{children:["Shorthand for ",(0,s.jsx)(n.code,{children:"someOf"})," with ",(0,s.jsx)(n.code,{children:"min: 1"}),"."]})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"primitive"})," package also exposes focused helpers such as ",(0,s.jsx)(n.code,{children:"SamplingGenerator"})," if you need to build your own weighted/unique sampling behaviour."]}),"\n",(0,s.jsx)(n.h2,{id:"lifting-generators-into-richer-structures",children:"Lifting generators into richer structures"}),"\n",(0,s.jsx)(n.p,{children:"Because every generator is itself a value, you can express arbitrarily nested data structures:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"final usernameGen = Gen.string(minLength: 3, maxLength: 20);\nfinal userGen = usernameGen.flatMap((username) {\n  return Specialized.email(domains: ['work.com']).flatMap((email) {\n    return Gen.integer(min: 18, max: 80).map((age) {\n      return User(username: username, email: email, age: age);\n    });\n  });\n});\n\nfinal paginatedResponseGen = Gen.integer(min: 0, max: 100).flatMap((page) {\n  return userGen.list(minLength: 1, maxLength: 20).map((items) {\n    return {\n      'page': page,\n      'items': items,\n      'nextPage': page < 99 ? page + 1 : null,\n    };\n  });\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:"Common recipes:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Use nested ",(0,s.jsx)(n.code,{children:"flatMap"})," calls (or helper functions) to assemble Dart records or domain objects from multiple generators."]}),"\n",(0,s.jsxs)(n.li,{children:["Wrap a list generator in ",(0,s.jsx)(n.code,{children:"Gen.containerOf"})," to build sets or queues."]}),"\n",(0,s.jsxs)(n.li,{children:["Balance positive/negative cases with ",(0,s.jsx)(n.code,{children:"Gen.frequency"}),", e.g. 80\u202f% valid values and 20\u202f% invalid ones to test validation."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"implementing-custom-generators",children:"Implementing custom generators"}),"\n",(0,s.jsxs)(n.p,{children:["Special behaviour is one subclass away. Override ",(0,s.jsx)(n.code,{children:"generate(Random)"})," and return a ",(0,s.jsx)(n.code,{children:"ShrinkableValue"})," with your own shrink ordering:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"class MoneyGenerator extends Generator<Money> {\n  @override\n  ShrinkableValue<Money> generate(Random random) {\n    final cents = random.nextInt(500_00); // up to $5,000.00\n    final currency = Gen.oneOf(['USD', 'EUR', 'JPY']).generate(random).value;\n    final value = Money.fromCents(currency: currency, cents: cents);\n\n    return ShrinkableValue(value, () sync* {\n      // Remove cents first, then shrink toward zero\n      if (value.cents % 100 != 0) {\n        yield ShrinkableValue.leaf(Money.fromCents(\n          currency: currency,\n          cents: value.cents - (value.cents % 100),\n        ));\n      }\n      if (value.cents > 0) {\n        yield ShrinkableValue.leaf(\n          Money.fromCents(currency: currency, cents: value.cents ~/ 2),\n        );\n        yield ShrinkableValue.leaf(\n          Money.fromCents(currency: currency, cents: 0),\n        );\n      }\n    });\n  }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Because shrinking is under your control, you can encode the shortest path to interesting boundary conditions."})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>o});var t=r(6540);const s={},i=t.createContext(s);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);