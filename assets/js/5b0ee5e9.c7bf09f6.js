"use strict";(globalThis.webpackChunkrouted=globalThis.webpackChunkrouted||[]).push([[2703],{2205:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"browser/installation","title":"Installation & CI","description":"Install browsers and drivers, version pinning, OS dependencies and CI notes","source":"@site/docs/server-testing/browser/installation.mdx","sourceDirName":"browser","slug":"/browser/installation","permalink":"/docs/server_testing/browser/installation","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/server-testing/browser/installation.mdx","tags":[],"version":"current","frontMatter":{"title":"Installation & CI","description":"Install browsers and drivers, version pinning, OS dependencies and CI notes"},"sidebar":"serverTestingSidebar","previous":{"title":"Force reinstall & cache","permalink":"/docs/server_testing/browser/force-reinstall-and-cache"},"next":{"title":"Screenshots & logs","permalink":"/docs/server_testing/browser/screenshots-and-logs"}}');var i=r(4848),t=r(8453);const l={title:"Installation & CI",description:"Install browsers and drivers, version pinning, OS dependencies and CI notes"},o="Installation & CI",d={},a=[{value:"Version pinning",id:"version-pinning",level:2},{value:"Updating bundled browser + driver versions (maintainers)",id:"updating-bundled-browser--driver-versions-maintainers",level:2},{value:"OS dependencies",id:"os-dependencies",level:2},{value:"Permissions",id:"permissions",level:2},{value:"CI",id:"ci",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"installation--ci",children:"Installation & CI"})}),"\n",(0,i.jsx)(n.h2,{id:"version-pinning",children:"Version pinning"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"server_testing uses an internal registry (browsers.json) that maps platform -> revision."}),"\n",(0,i.jsx)(n.li,{children:"You can pin a specific channel via BrowserConfig.browserName (e.g., chromium, firefox) and set forceReinstall for clean rebuilds."}),"\n",(0,i.jsx)(n.li,{children:"Drivers are managed automatically per browser type."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"updating-bundled-browser--driver-versions-maintainers",children:"Updating bundled browser + driver versions (maintainers)"}),"\n",(0,i.jsx)(n.p,{children:"The Playwright browser revisions and ChromeDriver version are generated from upstream sources. To refresh them:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd packages/server_testing/server_testing\ndart run build_runner build -d\n"})}),"\n",(0,i.jsx)(n.p,{children:"This regenerates:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"lib/src/browser/bootstrap/browsers_json_const.dart"})," (Playwright browsers.json)"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"lib/src/browser/bootstrap/devices_json_const.dart"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"lib/src/browser/bootstrap/driver/chrome_driver_version.dart"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"lib/src/browser/bootstrap/driver/gecko_driver_version.dart"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Verify the updates:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dart run server_testing install"})," (downloads updated browser bundles)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dart run server_testing install:driver chrome --force"})," (refresh ChromeDriver)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dart run server_testing install:driver firefox --force"})," (refresh GeckoDriver)"]}),"\n",(0,i.jsx)(n.li,{children:"Run browser-focused tests in this package after updating."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"os-dependencies",children:"OS dependencies"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Linux: ensure common X/GL libraries and fonts are installed. Headless runs still need libX11 and font packages."}),"\n",(0,i.jsx)(n.li,{children:"macOS: no extra deps for headless; permissions may prompt when running headed for the first time."}),"\n",(0,i.jsx)(n.li,{children:"Windows: no exec-bit concerns; ensure .exe binaries are accessible."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"permissions",children:"Permissions"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"On Linux/macOS, executables are chmod +x after extraction. If using a custom directory, ensure your user can write and execute."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"ci",children:"CI"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Prefer headless. Configure BrowserConfig(headless: true) and autoInstall: true."}),"\n",(0,i.jsx)(n.li,{children:"Cache the registry directory to speed up builds. Default cache: ~/.server_testing (override with SERVER_TESTING_CACHE_DIR)"}),"\n",(0,i.jsx)(n.li,{children:"Artifacts: store test_screenshots/ and logs for debugging failures."}),"\n",(0,i.jsxs)(n.li,{children:["For unusual Linux distros or custom CI images, you can override platform detection with:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"SERVER_TESTING_PLATFORM"})," (linux, mac, win)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"SERVER_TESTING_PLATFORM_ID"})," (e.g., ubuntu22.04-x64, mac13-arm64, win64)"]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>o});var s=r(6540);const i={},t=s.createContext(i);function l(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);