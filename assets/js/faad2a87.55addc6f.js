"use strict";(globalThis.webpackChunkrouted=globalThis.webpackChunkrouted||[]).push([[7147],{88:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"turbo-streams","title":"Turbo Streams","description":"Turbo Streams deliver page changes as `` HTML fragments. Each fragment specifies an action (what to do) and a target (which DOM element to act on). The browser\'s Turbo library processes these fragments and updates the page without a full reload.","source":"@site/docs/routed_hotwire/turbo-streams.mdx","sourceDirName":".","slug":"/turbo-streams","permalink":"/docs/routed_hotwire/turbo-streams","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/routed_hotwire/turbo-streams.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Turbo Streams","sidebar_position":1},"sidebar":"routedHotwireSidebar","previous":{"title":"Routed Hotwire","permalink":"/docs/routed_hotwire/"},"next":{"title":"Requests & Responses","permalink":"/docs/routed_hotwire/requests-responses"}}');var s=r(4848),i=r(8453);const d={title:"Turbo Streams",sidebar_position:1},a="Turbo Streams",o={},l=[{value:"The <code>turboStream</code> Builder",id:"the-turbostream-builder",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Actions",id:"actions",level:2},{value:"Convenience Builders",id:"convenience-builders",level:2},{value:"Function Signatures",id:"function-signatures",level:3},{value:"Combining Multiple Fragments",id:"combining-multiple-fragments",level:2},{value:"Targeting Multiple Elements",id:"targeting-multiple-elements",level:2},{value:"Custom Attributes",id:"custom-attributes",level:2},{value:"Body Normalization",id:"body-normalization",level:2}];function c(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"turbo-streams",children:"Turbo Streams"})}),"\n",(0,s.jsxs)(t.p,{children:["Turbo Streams deliver page changes as ",(0,s.jsx)(t.code,{children:"<turbo-stream>"})," HTML fragments. Each fragment specifies an ",(0,s.jsx)(t.strong,{children:"action"})," (what to do) and a ",(0,s.jsx)(t.strong,{children:"target"})," (which DOM element to act on). The browser's Turbo library processes these fragments and updates the page without a full reload."]}),"\n",(0,s.jsxs)(t.h2,{id:"the-turbostream-builder",children:["The ",(0,s.jsx)(t.code,{children:"turboStream"})," Builder"]}),"\n",(0,s.jsxs)(t.p,{children:["The core function builds a single ",(0,s.jsx)(t.code,{children:"<turbo-stream>"})," element:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-dart",children:"import 'package:routed_hotwire/routed_hotwire.dart';\n\nfinal html = turboStream(\n  action: TurboStreamAction.append,\n  target: 'messages',\n  html: '<li>New message</li>',\n);\n// => <turbo-stream action=\"append\" target=\"messages\"><template><li>New message</li></template></turbo-stream>\n"})}),"\n",(0,s.jsx)(t.h3,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Parameter"}),(0,s.jsx)(t.th,{children:"Type"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"action"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"TurboStreamAction"})," (required)"]}),(0,s.jsx)(t.td,{children:"Which DOM mutation to perform"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"target"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"String?"})}),(0,s.jsx)(t.td,{children:"A single DOM element ID"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"targets"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"String?"})}),(0,s.jsx)(t.td,{children:"A CSS selector matching multiple elements"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"html"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"String?"})}),(0,s.jsx)(t.td,{children:"The inner HTML content"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"attributes"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Map<String, String>?"})}),(0,s.jsxs)(t.td,{children:["Extra attributes on the ",(0,s.jsx)(t.code,{children:"<turbo-stream>"})," element"]})]})]})]}),"\n",(0,s.jsxs)(t.p,{children:["Content is automatically wrapped in a ",(0,s.jsx)(t.code,{children:"<template>"})," tag for all actions except ",(0,s.jsx)(t.code,{children:"remove"})," and ",(0,s.jsx)(t.code,{children:"refresh"}),", which don't need inner content."]}),"\n",(0,s.jsx)(t.h2,{id:"actions",children:"Actions"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"TurboStreamAction"})," enum covers all 8 standard Turbo Stream actions:"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Action"}),(0,s.jsx)(t.th,{children:"Description"}),(0,s.jsx)(t.th,{children:"Requires HTML?"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"append"})}),(0,s.jsx)(t.td,{children:"Append content inside the target element"}),(0,s.jsx)(t.td,{children:"Yes"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"prepend"})}),(0,s.jsx)(t.td,{children:"Prepend content inside the target element"}),(0,s.jsx)(t.td,{children:"Yes"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"replace"})}),(0,s.jsx)(t.td,{children:"Replace the entire target element"}),(0,s.jsx)(t.td,{children:"Yes"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"update"})}),(0,s.jsx)(t.td,{children:"Replace the target's inner content"}),(0,s.jsx)(t.td,{children:"Yes"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"remove"})}),(0,s.jsx)(t.td,{children:"Remove the target element from the DOM"}),(0,s.jsx)(t.td,{children:"No"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"before"})}),(0,s.jsx)(t.td,{children:"Insert content before the target element"}),(0,s.jsx)(t.td,{children:"Yes"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"after"})}),(0,s.jsx)(t.td,{children:"Insert content after the target element"}),(0,s.jsx)(t.td,{children:"Yes"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"refresh"})}),(0,s.jsx)(t.td,{children:"Trigger a Turbo page refresh"}),(0,s.jsx)(t.td,{children:"No"})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"convenience-builders",children:"Convenience Builders"}),"\n",(0,s.jsxs)(t.p,{children:["Each action has a dedicated function so you don't need to pass the ",(0,s.jsx)(t.code,{children:"action"})," parameter:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-dart",children:"// Append a new row to a table body\nturboStreamAppend(\n  target: 'user-list',\n  html: '<tr><td>Alice</td><td>alice@example.com</td></tr>',\n);\n\n// Prepend a notification\nturboStreamPrepend(\n  target: 'notifications',\n  html: '<div class=\"alert\">New notification</div>',\n);\n\n// Replace an entire element\nturboStreamReplace(\n  target: 'user-42',\n  html: '<div id=\"user-42\">Updated content</div>',\n);\n\n// Update only the inner content\nturboStreamUpdate(\n  target: 'counter',\n  html: '42',\n);\n\n// Remove an element\nturboStreamRemove(target: 'old-item');\n\n// Insert before a target\nturboStreamBefore(\n  target: 'footer',\n  html: '<div>Inserted before footer</div>',\n);\n\n// Insert after a target\nturboStreamAfter(\n  target: 'header',\n  html: '<div>Inserted after header</div>',\n);\n\n// Trigger a page refresh\nturboStreamRefresh(requestId: 'abc-123');\n"})}),"\n",(0,s.jsx)(t.h3,{id:"function-signatures",children:"Function Signatures"}),"\n",(0,s.jsxs)(t.p,{children:["All content-bearing functions require ",(0,s.jsx)(t.code,{children:"target"})," and ",(0,s.jsx)(t.code,{children:"html"})," as named parameters. ",(0,s.jsx)(t.code,{children:"turboStreamRemove"})," requires only ",(0,s.jsx)(t.code,{children:"target"}),". ",(0,s.jsx)(t.code,{children:"turboStreamRefresh"})," takes an optional ",(0,s.jsx)(t.code,{children:"requestId"}),". All accept optional ",(0,s.jsx)(t.code,{children:"attributes"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"combining-multiple-fragments",children:"Combining Multiple Fragments"}),"\n",(0,s.jsxs)(t.p,{children:["A single response can contain multiple stream fragments. Use ",(0,s.jsx)(t.code,{children:"joinTurboStreams"})," to concatenate them:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-dart",children:"final payload = joinTurboStreams([\n  turboStreamAppend(target: 'messages', html: '<li>Hello</li>'),\n  turboStreamUpdate(target: 'unread-count', html: '3'),\n  turboStreamRemove(target: 'empty-state'),\n]);\n\n// Send as a Turbo Stream response\nreturn ctx.turboStream(payload);\n"})}),"\n",(0,s.jsx)(t.h2,{id:"targeting-multiple-elements",children:"Targeting Multiple Elements"}),"\n",(0,s.jsxs)(t.p,{children:["Use the ",(0,s.jsx)(t.code,{children:"targets"})," parameter with a CSS selector to act on multiple elements at once:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-dart",children:"turboStream(\n  action: TurboStreamAction.update,\n  targets: '.price-display',\n  html: '\\$9.99',\n);\n// => <turbo-stream action=\"update\" targets=\".price-display\"><template>$9.99</template></turbo-stream>\n"})}),"\n",(0,s.jsx)(t.h2,{id:"custom-attributes",children:"Custom Attributes"}),"\n",(0,s.jsxs)(t.p,{children:["Pass extra attributes to the ",(0,s.jsx)(t.code,{children:"<turbo-stream>"})," element via the ",(0,s.jsx)(t.code,{children:"attributes"})," parameter:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-dart",children:"turboStreamAppend(\n  target: 'feed',\n  html: '<article>New post</article>',\n  attributes: {'method': 'morph'},\n);\n// => <turbo-stream action=\"append\" target=\"feed\" method=\"morph\"><template><article>New post</article></template></turbo-stream>\n"})}),"\n",(0,s.jsx)(t.p,{children:"Attribute values are automatically HTML-escaped."}),"\n",(0,s.jsx)(t.h2,{id:"body-normalization",children:"Body Normalization"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"normalizeTurboStreamBody"})," coerces different input types into a single string for response bodies:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-dart",children:"// String passes through\nnormalizeTurboStreamBody('<turbo-stream ...>');\n\n// Iterable is joined\nnormalizeTurboStreamBody([fragment1, fragment2]);\n\n// Anything else throws ArgumentError\n"})}),"\n",(0,s.jsxs)(t.p,{children:["This is used internally by ",(0,s.jsx)(t.code,{children:"TurboResponse.stream()"})," and ",(0,s.jsx)(t.code,{children:"ctx.turboStream()"}),", so you typically don't need to call it directly."]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,t,r)=>{r.d(t,{R:()=>d,x:()=>a});var n=r(6540);const s={},i=n.createContext(s);function d(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);