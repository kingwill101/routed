"use strict";(globalThis.webpackChunkrouted=globalThis.webpackChunkrouted||[]).push([[3529],{8453:(e,r,s)=>{s.d(r,{R:()=>a,x:()=>i});var n=s(6540);const t={},o=n.createContext(t);function a(e){const r=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),n.createElement(o.Provider,{value:r},e.children)}},8820:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"examples/browser","title":"Browser Examples","description":"Real-browser automation patterns with server_testing","source":"@site/docs/server-testing/examples/browser.mdx","sourceDirName":"examples","slug":"/examples/browser","permalink":"/docs/server_testing/examples/browser","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/server-testing/examples/browser.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Browser Examples","description":"Real-browser automation patterns with server_testing","sidebar_position":2},"sidebar":"serverTestingSidebar","previous":{"title":"Server Examples","permalink":"/docs/server_testing/examples/server"},"next":{"title":"CLI","permalink":"/docs/server_testing/cli"}}');var t=s(4848),o=s(8453);const a={title:"Browser Examples",description:"Real-browser automation patterns with server_testing",sidebar_position:2},i="Browser Examples",l={},d=[{value:"Shared Handler, Real Browser Flow",id:"shared-handler-real-browser-flow",level:2},{value:"Device Emulation Override",id:"device-emulation-override",level:2},{value:"Headed Chromium for Debugging",id:"headed-chromium-for-debugging",level:2},{value:"Screenshot on Failure",id:"screenshot-on-failure",level:2}];function c(e){const r={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"browser-examples",children:"Browser Examples"})}),"\n",(0,t.jsx)(r.p,{children:"Pair the browser tooling with the same handler logic you use for HTTP tests."}),"\n",(0,t.jsx)(r.h2,{id:"shared-handler-real-browser-flow",children:"Shared Handler, Real Browser Flow"}),"\n",(0,t.jsxs)(r.p,{children:["Reuse the ",(0,t.jsx)(r.code,{children:"TestClient.ephemeralServer"})," base URL inside ",(0,t.jsx)(r.code,{children:"browserGroup"}),"."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-dart",children:"import 'package:server_testing/server_testing.dart';\nimport 'package:test/test.dart';\n\nFuture<void> main() async {\n  final handler = RouterHandler(buildRouter());\n  final client = TestClient.ephemeralServer(handler);\n  final baseUrl = await client.baseUrlFuture;\n\n  await testBootstrap(BrowserConfig(browserName: 'firefox', headless: true));\n\n  browserGroup('customer flow', baseUrl: baseUrl, define: (getBrowser) {\n    test('can place order', () async {\n      final browser = getBrowser();\n      await browser.visit('/orders/new');\n      await browser.type('input[name=\"product\"]', 'Widget');\n      await browser.click('button[type=\"submit\"]');\n      await browser.assertSee('Order confirmed');\n    });\n  });\n\n  tearDownAll(() async => client.close());\n}\n"})}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsxs)(r.p,{children:["Because the same handler serves both HTTP and browser tests, you can seed data through the ",(0,t.jsx)(r.code,{children:"TestClient"})," before visiting the UI."]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"device-emulation-override",children:"Device Emulation Override"}),"\n",(0,t.jsx)(r.p,{children:"Run the same flow with a mobile device profile."}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-dart",children:"import 'package:server_testing/server_testing.dart';\nimport 'package:server_testing/src/browser/bootstrap/devices_json_const.dart';\n\nbrowserTest(\n  'mobile checkout',\n  (browser) async {\n    await browser.visit('/orders/new');\n    await browser.assertSee('Menu');\n  },\n  device: devicesJsonData['Pixel 5'],\n  headless: true,\n);\n"})}),"\n",(0,t.jsx)(r.h2,{id:"headed-chromium-for-debugging",children:"Headed Chromium for Debugging"}),"\n",(0,t.jsx)(r.p,{children:"Toggle headless mode off when you need to watch the browser."}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-dart",children:"browserTest(\n  'debug run in chrome',\n  (browser) async {\n    await browser.visit('/');\n    await browser.assertTitleContains('Demo Store');\n  },\n  browserType: ChromiumType(),\n  headless: false,\n  args: ['--auto-open-devtools-for-tabs'],\n);\n"})}),"\n",(0,t.jsx)(r.h2,{id:"screenshot-on-failure",children:"Screenshot on Failure"}),"\n",(0,t.jsx)(r.p,{children:"Enable automatic screenshots in the global bootstrap configuration."}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-dart",children:"Future<void> main() async {\n  await testBootstrap(BrowserConfig(\n    browserName: 'chromium',\n    autoScreenshots: true,\n    screenshotDirectory: 'test_screenshots',\n  ));\n\n  browserTest('captures screenshot', (browser) async {\n    await browser.visit('/broken');\n    await browser.assertSee('still reachable'); // fails -> screenshot saved\n  });\n}\n"})})]})}function h(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);