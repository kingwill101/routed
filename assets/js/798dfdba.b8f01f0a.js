"use strict";(self.webpackChunkrouted=self.webpackChunkrouted||[]).push([[8002],{2589:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"routed/fundamentals/binding","title":"Data Binding","description":"Bind request payloads to maps or custom models","source":"@site/docs/routed/fundamentals/binding.mdx","sourceDirName":"routed/fundamentals","slug":"/routed/fundamentals/binding","permalink":"/docs/routed/fundamentals/binding","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/routed/fundamentals/binding.mdx","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"title":"Data Binding","description":"Bind request payloads to maps or custom models","sidebar_position":8},"sidebar":"tutorialSidebar","previous":{"title":"Fallback precedence","permalink":"/docs/routed/fundamentals/fallback-precedence"},"next":{"title":"Response compression","permalink":"/docs/routed/fundamentals/compression"}}');var r=i(4848),d=i(8453);const s={title:"Data Binding",description:"Bind request payloads to maps or custom models",sidebar_position:8},t="Data Binding",l={},o=[{value:"Basic Binding",id:"basic-binding",level:2},{value:"Binding into models",id:"binding-into-models",level:3},{value:"Specific Binding Types",id:"specific-binding-types",level:2},{value:"JSON Binding",id:"json-binding",level:3},{value:"Form Data Binding",id:"form-data-binding",level:3},{value:"Query Parameter Binding",id:"query-parameter-binding",level:3},{value:"Required Binding",id:"required-binding",level:2},{value:"Binding &amp; Validation Options",id:"binding--validation-options",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"data-binding",children:"Data Binding"})}),"\n",(0,r.jsx)(n.p,{children:"Routed provides several methods to bind incoming request data to your data structures. Choose the helper that matches your source and desired failure behavior:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",metastring:'title="Import binding helpers"',children:"import 'package:routed/bindings.dart';\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"bind(target)"})," \u2013 auto-detects content type (",(0,r.jsx)(n.code,{children:"application/json"}),", ",(0,r.jsx)(n.code,{children:"application/x-www-form-urlencoded"}),", ",(0,r.jsx)(n.code,{children:"multipart/form-data"}),", ",(0,r.jsx)(n.code,{children:"text/plain"}),") and merges parsed values into ",(0,r.jsx)(n.code,{children:"target"}),". ",(0,r.jsx)(n.code,{children:"target"})," can be a ",(0,r.jsx)(n.code,{children:"Map"})," or implement ",(0,r.jsx)(n.code,{children:"Bindable"}),". Existing keys in a map are preserved unless overwritten by parsed values."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"shouldBindWith(target, binder)"})," \u2013 runs a specific binder (for example, ",(0,r.jsx)(n.code,{children:"jsonBinding"}),", ",(0,r.jsx)(n.code,{children:"formBinding"}),", ",(0,r.jsx)(n.code,{children:"queryBinding"}),"), useful when you want to be explicit regardless of ",(0,r.jsx)(n.code,{children:"Content-Type"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"mustBindWith(target, binder)"})," \u2013 same as above, but fails the request immediately with an error response when binding fails (for example, malformed JSON)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Note: Request bodies are streams. Once a JSON/form body has been consumed by a binder, it cannot be read again. Call only one body binder per request (you can still bind query params separately)."}),"\n",(0,r.jsx)(n.h2,{id:"basic-binding",children:"Basic Binding"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:'router.post(\'/users\', (ctx) async {\n  final data = <String, dynamic>{\n    // Pre-seed defaults; bind() merges into this map\n    \'role\': \'user\',\n  };\n\n  // Automatically bind request data based on content type\n  await ctx.bind(data);\n\n  // Or specify binding type (all helpers return the bound target)\n  await ctx.bindJSON(data);    // JSON body\n  await ctx.bindQuery(data);   // Query parameters\n\n  // data now contains merged values from the body and/or query\n  // e.g., { "role": "user", "name": "Ada" }\n});\n'})}),"\n",(0,r.jsx)(n.h3,{id:"binding-into-models",children:"Binding into models"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"class CreateUserRequest implements Bindable {\n  String name = '';\n  String email = '';\n\n  @override\n  void bind(Map<String, dynamic> data) {\n    name = data['name'] as String? ?? '';\n    email = data['email'] as String? ?? '';\n  }\n}\n\nrouter.post('/users', (ctx) async {\n  final request = await ctx.bind(CreateUserRequest());\n  return ctx.json({'name': request.name, 'email': request.email});\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"specific-binding-types",children:"Specific Binding Types"}),"\n",(0,r.jsx)(n.h3,{id:"json-binding",children:"JSON Binding"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"router.post('/api/users', (ctx) async {\n  final userData = <String, dynamic>{};\n  \n  // Bind JSON request body\n  await ctx.shouldBindWith(userData, jsonBinding);\n  \n  // Data is now available in userData\n  print(userData['name']);\n  print(userData['email']);\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"form-data-binding",children:"Form Data Binding"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"router.post('/submit-form', (ctx) async {\n  final formData = <String, dynamic>{};\n  \n  // Bind form data\n  await ctx.shouldBindWith(formData, formBinding);\n  \n  // Access form fields\n  print(formData['username']);\n  print(formData['password']);\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For file uploads use ",(0,r.jsx)(n.code,{children:"ctx.formFile('field')"})," / ",(0,r.jsx)(n.code,{children:"ctx.formFiles('field')"})," alongside ",(0,r.jsx)(n.code,{children:"formBinding"}),"\u2014files are not inserted into the bound map."]}),"\n",(0,r.jsx)(n.h3,{id:"query-parameter-binding",children:"Query Parameter Binding"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"router.get('/search', (ctx) async {\n  final searchParams = <String, dynamic>{};\n  \n  // Bind query parameters\n  await ctx.shouldBindWith(searchParams, queryBinding);\n  \n  // Access search parameters\n  print(searchParams['q']);\n  print(searchParams['page']);\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"required-binding",children:"Required Binding"}),"\n",(0,r.jsx)(n.p,{children:"When binding must succeed:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"router.post('/critical', (ctx) async {\n  final data = <String, dynamic>{};\n\n  // Throws and aborts with an error response if binding fails\n  await ctx.mustBindWith(data, jsonBinding);\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"mustBindWith"}),", ",(0,r.jsx)(n.code,{children:"bind"}),", ",(0,r.jsx)(n.code,{children:"bindJSON"}),", and the other helpers all return ",(0,r.jsx)(n.code,{children:"Future<T>"})," (the same target instance). Always ",(0,r.jsx)(n.code,{children:"await"})," them so that asynchronous binders (JSON, multipart, etc.) finish before continuing."]}),"\n",(0,r.jsx)(n.p,{children:"Cautions:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Binding reads the request body once. Avoid calling multiple body binders (",(0,r.jsx)(n.code,{children:"bindJSON"}),", ",(0,r.jsx)(n.code,{children:"formBinding"}),", etc.) in the same request."]}),"\n",(0,r.jsxs)(n.li,{children:["Maps are merged; pre-seeded defaults in your ",(0,r.jsx)(n.code,{children:"target"})," map are kept unless the incoming data supplies the same keys."]}),"\n",(0,r.jsx)(n.li,{children:"Prefer explicit binders in endpoints that accept both JSON and forms to avoid ambiguity."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"binding--validation-options",children:"Binding & Validation Options"}),"\n",(0,r.jsxs)(n.p,{children:["Bind first, then validate. All bindings share a common validation pipeline powered by ",(0,r.jsx)(n.code,{children:"ctx.validate()"}),". You can pass options directly to validation:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"await ctx.validate(\n  {\n    'email': 'required|email',\n    'password': 'required|min:12',\n  },\n  bail: true, // stop at first failure per field\n  messages: {\n    'email.email': 'Please supply a company email address.',\n    'password.min': 'Use a longer password.',\n  },\n);\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"bail: true"})," short-circuits validation for a field after the first failed rule."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"messages"})," lets you override rule messages globally (",(0,r.jsx)(n.code,{children:"'min'"}),") or per-field/per-rule (",(0,r.jsx)(n.code,{children:"'password.min'"}),")."]}),"\n",(0,r.jsx)(n.li,{children:"When multiple rules fail, Routed accumulates every message in order, so clients receive the full set of violations."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Common pattern:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"router.post('/signup', (ctx) async {\n  final payload = <String, dynamic>{};\n  await ctx.bind(payload); // auto-detect; or use shouldBindWith(payload, jsonBinding)\n\n  await ctx.validate({\n    'email': 'required|email',\n    'password': 'required|min:12',\n    'name': 'nullable|string|min:2',\n  });\n\n  return ctx.json({'ok': true});\n});\n"})})]})}function u(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>t});var a=i(6540);const r={},d=a.createContext(r);function s(e){const n=a.useContext(d);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(d.Provider,{value:n},e.children)}}}]);