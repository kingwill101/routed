"use strict";(globalThis.webpackChunkrouted=globalThis.webpackChunkrouted||[]).push([[7716],{37:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>p,frontMatter:()=>s,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"index","title":"Routed Inertia","description":"Inertia.js middleware, SSR, and assets for Routed apps","source":"@site/docs/routed_inertia/index.mdx","sourceDirName":".","slug":"/","permalink":"/docs/routed_inertia/","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/routed_inertia/index.mdx","tags":[],"version":"current","sidebarPosition":0,"frontMatter":{"title":"Routed Inertia","description":"Inertia.js middleware, SSR, and assets for Routed apps","sidebar_position":0},"sidebar":"routedInertiaSidebar","next":{"title":"Tutorial: Build a Todo App","permalink":"/docs/routed_inertia/tutorial"}}');var a=r(4848),i=r(8453);const s={title:"Routed Inertia",description:"Inertia.js middleware, SSR, and assets for Routed apps",sidebar_position:0},d="Routed Inertia",l={},o=[{value:"Features",id:"features",level:2},{value:"Install",id:"install",level:2},{value:"Start a project",id:"start-a-project",level:2},{value:"Quick start",id:"quick-start",level:2},{value:"Provider + config setup",id:"provider--config-setup",level:2},{value:"Shared props + errors",id:"shared-props--errors",level:2},{value:"SSR + templates",id:"ssr--templates",level:2},{value:"Asset manifest helper",id:"asset-manifest-helper",level:2},{value:"Testing",id:"testing",level:2},{value:"Example app",id:"example-app",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"routed-inertia",children:"Routed Inertia"})}),"\n",(0,a.jsxs)(n.p,{children:["Routed Inertia wires Inertia.js into Routed with middleware, ",(0,a.jsx)(n.code,{children:"EngineContext"}),"\nhelpers, and SSR support so you can serve SPA-like pages from a Dart backend."]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"New to Inertia?"})," Follow the ",(0,a.jsx)(n.a,{href:"/docs/routed_inertia/tutorial",children:"Build a Todo App"})," tutorial for a hands-on walkthrough."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ctx.inertia"})," response helpers for JSON + HTML payloads."]}),"\n",(0,a.jsx)(n.li,{children:"Shared props, flash messages, and error bags."}),"\n",(0,a.jsx)(n.li,{children:"Config-driven SSR, asset manifests, and Vite hot reload support."}),"\n",(0,a.jsx)(n.li,{children:"Testing helpers for Inertia responses."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"install",children:"Install"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"dart pub add routed_inertia\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"routed_inertia"})," re-exports the core server helpers from\n",(0,a.jsx)(n.code,{children:"package:inertia_dart/inertia_dart.dart"}),", so you can keep a single import in\nmost apps. The inertia_dart package provides the Inertia protocol helpers,\nasset manifest reader, SSR gateways, and middleware used under the hood."]}),"\n",(0,a.jsx)(n.h2,{id:"start-a-project",children:"Start a project"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Scaffold a Routed app with Inertia support:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"dart run routed create --name inertia_app --inertia\ncd inertia_app\n"})}),"\n",(0,a.jsxs)(n.p,{children:["This generates the full project structure including server configs, a Liquid\ntemplate, and a Vite + React client under ",(0,a.jsx)(n.code,{children:"client/"}),". You can also pass\n",(0,a.jsx)(n.code,{children:"--inertia-framework vue"})," or ",(0,a.jsx)(n.code,{children:"--inertia-framework svelte"})," for a different\nfrontend framework."]}),"\n",(0,a.jsxs)(n.ol,{start:"2",children:["\n",(0,a.jsx)(n.li,{children:"Add Inertia server dependencies:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"dart pub add routed_inertia\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"3",children:["\n",(0,a.jsx)(n.li,{children:"Scaffold the frontend with the inertia_dart CLI (recommended):"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"dart run inertia_dart:inertia create client --framework react --package-manager npm\n"})}),"\n",(0,a.jsx)(n.p,{children:"If you already have a Vite project, run:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"dart run inertia_dart:inertia install --framework react --package-manager npm --path client\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"4",children:["\n",(0,a.jsx)(n.li,{children:"Add a frontend client manually (optional):"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mkdir client\ncd client\nnpm init -y\nnpm install @inertiajs/core @inertiajs/react react react-dom\nnpm install -D vite @vitejs/plugin-react\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"5",children:["\n",(0,a.jsx)(n.li,{children:"Configure the server to read Inertia settings:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"# config/http.yaml\nproviders:\n  - routed.inertia\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'# config/inertia.yaml\nversion: "1.0.0"\nroot_view: "inertia/app"\nassets:\n  manifest_path: "client/dist/.vite/manifest.json"\n  entry: "index.html"\n  base_url: "/"\n  hot_file: "client/public/hot"\n'})}),"\n",(0,a.jsxs)(n.ol,{start:"6",children:["\n",(0,a.jsx)(n.li,{children:"Run dev servers:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# client\nnpm run dev\n\n# server (from app root)\ndart run routed dev\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"7",children:["\n",(0,a.jsx)(n.li,{children:"Configure static asset serving for production:"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Vite builds hashed assets into ",(0,a.jsx)(n.code,{children:"client/dist/assets/"}),". You need a storage disk\nand a static mount so Routed can serve them:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'# config/storage.yaml\ndefault: local\ndisks:\n  local:\n    driver: local\n    root: "storage/app"\n  public:\n    driver: local\n    root: "."\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"# config/static.yaml\nenabled: true\nmounts:\n  - route: /assets\n    disk: public\n    path: client/dist/assets\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Without the ",(0,a.jsx)(n.code,{children:"public"})," disk, paths resolve relative to the default disk root\n(",(0,a.jsx)(n.code,{children:"storage/app"}),"), causing 404s for static assets. See the\n",(0,a.jsx)(n.a,{href:"/docs/routed_inertia/tutorial#assets-return-404-in-production",children:"tutorial"}),"\nfor more details."]}),"\n",(0,a.jsxs)(n.p,{children:["The example app in ",(0,a.jsx)(n.code,{children:"packages/routed_inertia/example"})," includes a working Vite\nsetup, hot file wiring, and server integration if you want a full reference."]}),"\n",(0,a.jsx)(n.p,{children:"To manage the SSR worker, use the CLI commands:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"dart run inertia_dart:inertia ssr:start\ndart run inertia_dart:inertia ssr:check\ndart run inertia_dart:inertia ssr:stop\n"})}),"\n",(0,a.jsx)(n.h2,{id:"quick-start",children:"Quick start"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"import 'package:routed/routed.dart';\nimport 'package:routed_inertia/routed_inertia.dart';\n\nfinal engine = Engine(\n  options: [\n    withMiddleware([\n      RoutedInertiaMiddleware(versionResolver: () => '1.0.0').call,\n    ]),\n  ],\n);\n\nengine.get('/dashboard', (ctx) {\n  return ctx.inertia(\n    'Dashboard',\n    props: {'user': {'name': 'Ada'}},\n  );\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"provider--config-setup",children:"Provider + config setup"}),"\n",(0,a.jsxs)(n.p,{children:["Register the provider and enable it in ",(0,a.jsx)(n.code,{children:"http.yaml"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"import 'package:routed/routed.dart';\nimport 'package:routed_inertia/routed_inertia.dart';\n\nregisterRoutedInertiaProvider(ProviderRegistry.instance);\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"# config/http.yaml\nproviders:\n  - routed.inertia\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'# config/inertia.yaml\nversion: "1.0.0"\nroot_view: "inertia/app"\nhistory:\n  encrypt: false\nssr:\n  enabled: false\n  url: "http://127.0.0.1:13714"\nassets:\n  manifest_path: "client/dist/.vite/manifest.json"\n  entry: "index.html"\n  base_url: "/"\n  hot_file: "client/public/hot"\n'})}),"\n",(0,a.jsx)(n.p,{children:"If you need a custom version resolver, register the provider directly:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"final engine = Engine(\n  providers: [\n    CoreServiceProvider.withLoader(\n      ConfigLoader.yaml(configDirectory: 'config'),\n    ),\n    InertiaServiceProvider(versionResolver: () => '1.0.0'),\n  ],\n);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"shared-props--errors",children:"Shared props + errors"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"engine.get('/shared', (ctx) {\n  ctx.inertiaShare({'appName': 'Routed'});\n  return ctx.inertia('Shared', props: {'user': 'Ada'});\n});\n\nengine.post('/save', (ctx) {\n  ctx.inertiaFlash('notice', 'Saved');\n  ctx.inertiaErrors({'email': 'Required'});\n  return ctx.redirect('/form');\n});\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Select error bags with ",(0,a.jsx)(n.code,{children:"X-Inertia-Error-Bag"})," from the client."]}),"\n",(0,a.jsx)(n.h2,{id:"ssr--templates",children:"SSR + templates"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"engine.get('/', (ctx) {\n  return ctx.inertia(\n    'Home',\n    props: {'title': 'Hello'},\n    templateName: 'inertia/app',\n    ssrEnabled: true,\n    ssrGateway: HttpSsrGateway(Uri.parse('http://localhost:13714')),\n  );\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"asset-manifest-helper",children:"Asset manifest helper"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"final manifest = await InertiaAssetManifest.load('client/dist/.vite/manifest.json');\nfinal tags = manifest.renderTags('index.html', baseUrl: '/');\n"})}),"\n",(0,a.jsx)(n.p,{children:"Inject the tags in your template or HTML builder."}),"\n",(0,a.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"response.assertInertia((page) {\n  page.component('Dashboard').has('user.name');\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"example-app",children:"Example app"}),"\n",(0,a.jsxs)(n.p,{children:["See ",(0,a.jsx)(n.code,{children:"packages/routed_inertia/example/README.md"})," for a full React + Routed demo."]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>d});var t=r(6540);const a={},i=t.createContext(a);function s(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);