"use strict";(self.webpackChunkrouted=self.webpackChunkrouted||[]).push([[6719],{7742:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"server-testing/browser/pages-and-components","title":"Pages & Components","description":"Structure browser tests with reusable page objects and components","source":"@site/docs/server-testing/browser/pages-and-components.mdx","sourceDirName":"server-testing/browser","slug":"/server-testing/browser/pages-and-components","permalink":"/docs/server-testing/browser/pages-and-components","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/server-testing/browser/pages-and-components.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Pages & Components","description":"Structure browser tests with reusable page objects and components","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"BrowserConfig & Devices","permalink":"/docs/server-testing/browser/browser-config"},"next":{"title":"Force reinstall & cache","permalink":"/docs/server-testing/browser/force-reinstall-and-cache"}}');var r=s(4848),o=s(8453);const i={title:"Pages & Components",description:"Structure browser tests with reusable page objects and components",sidebar_position:3},a="Pages & Components",l={},c=[{value:"Defining Components",id:"defining-components",level:2},{value:"Building a Page",id:"building-a-page",level:2},{value:"Full Test (Shelf)",id:"full-test-shelf",level:2},{value:"Tips",id:"tips",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"pages--components",children:"Pages & Components"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"server_testing"})," includes ",(0,r.jsx)(n.code,{children:"Page"})," and ",(0,r.jsx)(n.code,{children:"Component"})," base classes inspired by the Page Object Model. They wrap a ",(0,r.jsx)(n.code,{children:"Browser"})," instance and expose ergonomic helpers for traversal, assertions, and nested component composition."]}),"\n",(0,r.jsx)(n.h2,{id:"defining-components",children:"Defining Components"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"class LoginForm extends Component {\n  LoginForm(super.browser, super.selector);\n  String get email => 'input[name=\"email\"]';\n  String get password => 'input[name=\"password\"]';\n  String get submit => 'button[type=\"submit\"]';\n  Future<void> fill(String e, String p) async { await type(email, e); await type(password, p); }\n  Future<void> submitForm() async => click(submit);\n}\n\nclass LoginPage extends Page {\n  LoginPage(super.browser);\n  @override\n  String get url => '/';\n  LoginForm get form => LoginForm(browser, '#login');\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Component"})," requires a ",(0,r.jsx)(n.code,{children:"Browser"})," and a selector that acts as the root. The helpers (",(0,r.jsx)(n.code,{children:"click"}),", ",(0,r.jsx)(n.code,{children:"type"}),", ",(0,r.jsx)(n.code,{children:"assertSeeIn"}),", etc.) automatically scope themselves to the component root."]}),"\n",(0,r.jsx)(n.h2,{id:"building-a-page",children:"Building a Page"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"class LoginPage extends Page {\n  LoginPage(super.browser);\n\n  @override\n  String get url => '/';\n\n  LoginForm get form => LoginForm(browser, '#login');\n\n  Future<void> navigateAndWait() async {\n    await navigate(); // provided by Page with baseUrl resolution\n    await browser.waiter.waitFor('#login');\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Pages extend ",(0,r.jsx)(n.code,{children:"Page"}),", provide a ",(0,r.jsx)(n.code,{children:"url"}),", and can expose lazy component getters."]}),"\n",(0,r.jsx)(n.h2,{id:"full-test-shelf",children:"Full Test (Shelf)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"final app = (shelf.Request req) async => shelf.Response.ok('''\n<html><head><title>Login</title></head>\n<body>\n  <div id=\"login\">\n    <form>\n      <input name=\"email\" />\n      <input name=\"password\" />\n      <button type=\"submit\">Login</button>\n    </form>\n    <div class=\"flash\" style=\"display:none\">OK</div>\n  </div>\n  <script>\n    document.querySelector('form').addEventListener('submit', function(e){\n      e.preventDefault();\n      document.querySelector('.flash').style.display='block';\n      document.title = 'Dashboard';\n    });\n  <\/script>\n</body>\n</html>\n''', headers: {'content-type': 'text/html'});\n\nfinal handler = ShelfRequestHandler(app);\nfinal client = TestClient.ephemeralServer(handler);\nfinal baseUrl = await client.baseUrlFuture;\n\nbrowserGroup('Page+Component', baseUrl: baseUrl, define: (getBrowser) {\n  test('login flow', () async {\n    final browser = getBrowser();\n    final page = LoginPage(browser);\n    await page.navigate();\n    await page.form.fill('user@example.com', 'secret');\n    await page.form.submitForm();\n    await browser.assertTitle('Dashboard');\n  });\n  tearDownAll(() async { await client.close(); });\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"tips",children:"Tips"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Keep selectors centralised."})," Put selectors in page/component classes to avoid scattering them across tests."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Expose behaviours, not raw interactions."})," Methods like ",(0,r.jsx)(n.code,{children:"fill"})," and ",(0,r.jsx)(n.code,{children:"submitForm"})," keep tests focused on outcomes."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Use ",(0,r.jsx)(n.code,{children:"navigate()"})]})," from the base ",(0,r.jsx)(n.code,{children:"Page"})," to respect the configured ",(0,r.jsx)(n.code,{children:"baseUrl"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Compose nested components."})," Components can expose other components for complex layouts (e.g. ",(0,r.jsx)(n.code,{children:"Sidebar"})," inside ",(0,r.jsx)(n.code,{children:"DashboardPage"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Share assertions."})," Add helper methods like ",(0,r.jsx)(n.code,{children:"expectFlashMessage(String text)"})," to encapsulate repeated checks."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Page objects are optional, but they pay off quickly as your browser suite grows."})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>a});var t=s(6540);const r={},o=t.createContext(r);function i(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);