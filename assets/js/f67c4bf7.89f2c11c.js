"use strict";(self.webpackChunkrouted=self.webpackChunkrouted||[]).push([[1330],{8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>l});var a=s(6540);const i={},t=a.createContext(i);function r(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(t.Provider,{value:n},e.children)}},9304:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"assertable json/schema-validation","title":"Schema Validation","description":"Learn about validating JSON structures against expected schemas","source":"@site/docs/assertable json/schema-validation.mdx","sourceDirName":"assertable json","slug":"/assertable json/schema-validation","permalink":"/docs/assertable json/schema-validation","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/assertable json/schema-validation.mdx","tags":[],"version":"current","frontMatter":{"title":"Schema Validation","description":"Learn about validating JSON structures against expected schemas"},"sidebar":"tutorialSidebar","previous":{"title":"Property Assertions","permalink":"/docs/assertable json/property-assertions"},"next":{"title":"Type & Value Assertions","permalink":"/docs/assertable json/type-value-assertions"}}');var i=s(4848),t=s(8453);const r={title:"Schema Validation",description:"Learn about validating JSON structures against expected schemas"},l="Schema Validation",c={},d=[{value:"Basic Schema Validation",id:"basic-schema-validation",level:2},{value:"Optional Fields",id:"optional-fields",level:2},{value:"Structure Validation with AssertableJsonString",id:"structure-validation-with-assertablejsonstring",level:2},{value:"Validating Arrays in Schemas",id:"validating-arrays-in-schemas",level:2},{value:"Combining Schema Validation with Other Assertions",id:"combining-schema-validation-with-other-assertions",level:2},{value:"Handling Complex Structures",id:"handling-complex-structures",level:2},{value:"Validating Schemas in Arrays",id:"validating-schemas-in-arrays",level:2},{value:"Schema Validation vs Structure Validation",id:"schema-validation-vs-structure-validation",level:2},{value:"Advanced Schema Validation Techniques",id:"advanced-schema-validation-techniques",level:2},{value:"Recursive Schema Validation",id:"recursive-schema-validation",level:3},{value:"Combining with Custom Logic",id:"combining-with-custom-logic",level:3},{value:"Complete Example",id:"complete-example",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"schema-validation",children:"Schema Validation"})}),"\n",(0,i.jsxs)(n.p,{children:["Validating the structure of JSON objects against an expected schema is a powerful way to ensure your data conforms to your requirements. The ",(0,i.jsx)(n.code,{children:"assertable_json"})," package provides robust tools for schema validation."]}),"\n",(0,i.jsx)(n.h2,{id:"basic-schema-validation",children:"Basic Schema Validation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"json.matchesSchema({\n  'id': int,\n  'name': String,\n  'email': String,\n  'isActive': bool,\n  'createdAt': String\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"matchesSchema"})," method validates that:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"All keys in the schema exist in the JSON"}),"\n",(0,i.jsx)(n.li,{children:"The values match the expected types"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"optional-fields",children:"Optional Fields"}),"\n",(0,i.jsx)(n.p,{children:"You can mark fields as optional by appending '?' to the key:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"json.matchesSchema({\n  'id': int,\n  'name': String,\n  'email': String,\n  'phone?': String,  // Optional field\n  'address?': Map    // Optional field\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"structure-validation-with-assertablejsonstring",children:"Structure Validation with AssertableJsonString"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"AssertableJsonString"})," class provides an ",(0,i.jsx)(n.code,{children:"assertStructure"})," method for more complex schema validation:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"final jsonString = AssertableJsonString(responseString);\n\njsonString.assertStructure({\n  'user': {\n    'id': int,\n    'name': String,\n    'email': String\n  },\n  'settings': {\n    'theme': String,\n    'notifications': bool\n  }\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"validating-arrays-in-schemas",children:"Validating Arrays in Schemas"}),"\n",(0,i.jsx)(n.p,{children:"For arrays with consistent structure, you can use wildcard patterns:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"jsonString.assertStructure({\n  'users': {\n    '*': [           // Wildcard for all array items\n      'id',\n      'name',\n      'email'\n    ]\n  },\n  'meta': {\n    'total': null,\n    'page': null\n  }\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:"This validates that each item in the 'users' array has 'id', 'name', and 'email' properties."}),"\n",(0,i.jsx)(n.h2,{id:"combining-schema-validation-with-other-assertions",children:"Combining Schema Validation with Other Assertions"}),"\n",(0,i.jsx)(n.p,{children:"Schema validation works well combined with other assertion types:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"json\n  // First validate the schema\n  .matchesSchema({\n    'id': int,\n    'name': String,\n    'email': String,\n    'isActive': bool\n  })\n  \n  // Then validate specific values\n  .where('id', 123)\n  .where('name', 'John Doe')\n  .whereContains('email', '@')\n  .where('isActive', true);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"handling-complex-structures",children:"Handling Complex Structures"}),"\n",(0,i.jsx)(n.p,{children:"For more complex schemas with nested objects and arrays:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"json.matchesSchema({\n  'user': Map,       // Validate as a Map without specifying contents\n  'items': List,     // Validate as a List without specifying contents\n  'settings': {      // Validate specific structure\n    'theme': String,\n    'language': String\n  }\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"validating-schemas-in-arrays",children:"Validating Schemas in Arrays"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"json.scope('users', (users) => {\n  users.each((user) => {\n    user.matchesSchema({\n      'id': int,\n      'name': String,\n      'email': String\n    });\n  });\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"schema-validation-vs-structure-validation",children:"Schema Validation vs Structure Validation"}),"\n",(0,i.jsx)(n.p,{children:"There are two main approaches to schema validation in the package:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"matchesSchema()"})})," - Used with ",(0,i.jsx)(n.code,{children:"AssertableJson"}),", focuses on type validation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"assertStructure()"})})," - Used with ",(0,i.jsx)(n.code,{children:"AssertableJsonString"}),", focuses on structure validation"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The key differences:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Feature"}),(0,i.jsx)(n.th,{children:"matchesSchema()"}),(0,i.jsx)(n.th,{children:"assertStructure()"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Class used with"}),(0,i.jsx)(n.td,{children:"AssertableJson"}),(0,i.jsx)(n.td,{children:"AssertableJsonString"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Primary focus"}),(0,i.jsx)(n.td,{children:"Type checking"}),(0,i.jsx)(n.td,{children:"Structure verification"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Handling of values"}),(0,i.jsx)(n.td,{children:"Validates types"}),(0,i.jsx)(n.td,{children:"Only checks existence"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Optional fields"}),(0,i.jsx)(n.td,{children:"Supports with '?' syntax"}),(0,i.jsx)(n.td,{children:"Less explicit support"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Array handling"}),(0,i.jsx)(n.td,{children:"Limited"}),(0,i.jsx)(n.td,{children:"Better with wildcards"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"advanced-schema-validation-techniques",children:"Advanced Schema Validation Techniques"}),"\n",(0,i.jsx)(n.h3,{id:"recursive-schema-validation",children:"Recursive Schema Validation"}),"\n",(0,i.jsx)(n.p,{children:"For deeply nested structures:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"json.matchesSchema({\n  'user': {\n    'id': int,\n    'profile': {\n      'settings': {\n        'preferences': {\n          'theme': String,\n          'language': String\n        }\n      }\n    }\n  }\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"combining-with-custom-logic",children:"Combining with Custom Logic"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"// First validate the schema\njson.matchesSchema({\n  'user': Map,\n  'settings': Map\n});\n\n// Then validate specific parts with custom logic\njson.scope('user', (user) => {\n  if (user.get<String>('role') == 'admin') {\n    user.matchesSchema({\n      'role': String,\n      'permissions': List,\n      'accessLevel': int\n    });\n  } else {\n    user.matchesSchema({\n      'role': String,\n      'permissions': List\n    });\n  }\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"test('testing API response structure', () {\n  final jsonString = '''\n  {\n    \"status\": \"success\",\n    \"data\": {\n      \"users\": [\n        {\n          \"id\": 1,\n          \"name\": \"John Doe\",\n          \"email\": \"john@example.com\",\n          \"profile\": {\n            \"avatar\": \"avatar1.jpg\",\n            \"bio\": \"Developer\"\n          }\n        },\n        {\n          \"id\": 2,\n          \"name\": \"Jane Smith\",\n          \"email\": \"jane@example.com\",\n          \"profile\": {\n            \"avatar\": \"avatar2.jpg\",\n            \"bio\": \"Designer\"\n          }\n        }\n      ],\n      \"pagination\": {\n        \"total\": 50,\n        \"page\": 1,\n        \"perPage\": 10\n      }\n    },\n    \"meta\": {\n      \"version\": \"1.0\",\n      \"timestamp\": 1609459200\n    }\n  }\n  ''';\n\n  final response = AssertableJsonString(jsonString);\n  \n  // Validate overall structure\n  response.assertStructure({\n    'status': null,\n    'data': {\n      'users': {\n        '*': [         // Each user has these fields\n          'id',\n          'name',\n          'email',\n          'profile'\n        ]\n      },\n      'pagination': {\n        'total': null,\n        'page': null,\n        'perPage': null\n      }\n    },\n    'meta': {\n      'version': null,\n      'timestamp': null\n    }\n  });\n  \n  // Now validate specific parts using AssertableJson\n  final json = AssertableJson(response.decoded);\n  \n  json\n    .whereType<String>('status')\n    .where('status', 'success')\n    \n    .scope('data.users', (users) => {\n      users.each((user) => {\n        user\n          .matchesSchema({\n            'id': int,\n            'name': String,\n            'email': String,\n            'profile': Map\n          });\n          \n        user.scope('profile', (profile) => {\n          profile.matchesSchema({\n            'avatar': String,\n            'bio': String\n          });\n        });\n      });\n    })\n    \n    .scope('data.pagination', (pagination) => {\n      pagination\n        .matchesSchema({\n          'total': int,\n          'page': int,\n          'perPage': int\n        });\n    })\n    \n    .scope('meta', (meta) => {\n      meta\n        .matchesSchema({\n          'version': String,\n          'timestamp': int\n        });\n    });\n});\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);