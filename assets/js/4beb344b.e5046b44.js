"use strict";(self.webpackChunkrouted=self.webpackChunkrouted||[]).push([[4435],{46:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>d,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"routed/fundamentals/headers","title":"Headers","description":"Inspect and mutate request/response headers","source":"@site/docs/routed/fundamentals/headers.mdx","sourceDirName":"routed/fundamentals","slug":"/routed/fundamentals/headers","permalink":"/docs/routed/fundamentals/headers","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/routed/fundamentals/headers.mdx","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Headers","description":"Inspect and mutate request/response headers","sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"HTTP Semantics","permalink":"/docs/routed/fundamentals/http-semantics"},"next":{"title":"Cookies","permalink":"/docs/routed/fundamentals/cookies"}}');var s=t(4848),a=t(8453);const d={title:"Headers",description:"Inspect and mutate request/response headers",sidebar_position:6},i="HTTP Headers",o={},c=[{value:"Reading Request Headers",id:"reading-request-headers",level:2},{value:"Setting Response Headers",id:"setting-response-headers",level:2},{value:"Common Headers",id:"common-headers",level:2},{value:"CORS Headers",id:"cors-headers",level:3},{value:"Cache Control",id:"cache-control",level:3},{value:"Security Headers",id:"security-headers",level:3},{value:"Content Negotiation",id:"content-negotiation",level:2},{value:"Custom Headers",id:"custom-headers",level:2},{value:"Header Middleware",id:"header-middleware",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"http-headers",children:"HTTP Headers"})}),"\n",(0,s.jsx)(n.p,{children:"Routed provides helpers to read and manipulate HTTP headers in both requests and responses. Header names are case-insensitive; prefer the request/response helpers rather than parsing raw maps."}),"\n",(0,s.jsx)(n.h2,{id:"reading-request-headers",children:"Reading Request Headers"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"router.get('/info', (ctx) {\n  // Get single header\n  final userAgent = ctx.requestHeader('User-Agent');\n  final contentType = ctx.requestHeader('Content-Type');\n  \n  // Access all headers\n  ctx.request.headers.forEach((name, values) {\n    print('$name: ${values.join(\", \")}');\n  });\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"setting-response-headers",children:"Setting Response Headers"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"router.get('/api', (ctx) {\n  // Set single header\n  ctx.setHeader('X-API-Version', 'v1');\n  \n  // Set multiple headers\n  ctx.setHeader('Cache-Control', 'public, max-age=3600');\n  ctx.setHeader('Access-Control-Allow-Origin', '*');\n  \n  ctx.json({'status': 'ok'});\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"common-headers",children:"Common Headers"}),"\n",(0,s.jsx)(n.h3,{id:"cors-headers",children:"CORS Headers"}),"\n",(0,s.jsx)(n.p,{children:"Prefer configuring CORS via the provider; if you set headers manually, remember to handle OPTIONS preflight requests and avoid wildcard origins with credentials."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"router.get('/api', (ctx) {\n  ctx.setHeader('Access-Control-Allow-Origin', '*');\n  ctx.setHeader('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE');\n  ctx.setHeader('Access-Control-Allow-Headers', 'Content-Type');\n  ctx.setHeader('Access-Control-Max-Age', '86400'); // 24 hours\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"cache-control",children:"Cache Control"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"router.get('/static', (ctx) {\n  ctx.setHeader('Cache-Control', 'public, max-age=31536000'); // 1 year\n  ctx.setHeader('ETag', generateETag(content));\n});\n\nrouter.get('/dynamic', (ctx) {\n  ctx.setHeader('Cache-Control', 'no-cache, no-store, must-revalidate');\n  ctx.setHeader('Pragma', 'no-cache');\n  ctx.setHeader('Expires', '0');\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"security-headers",children:"Security Headers"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"router.use((ctx, next) async {\n  // Common security headers\n  ctx.setHeader('X-Content-Type-Options', 'nosniff');\n  ctx.setHeader('X-Frame-Options', 'DENY');\n  ctx.setHeader('X-XSS-Protection', '1; mode=block');\n  ctx.setHeader('Strict-Transport-Security', 'max-age=31536000; includeSubDomains');\n  ctx.setHeader('Content-Security-Policy', \"default-src 'self'\");\n\n  return await next();\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:"Rather not hand-roll them? Configure the security provider once and let it manage header middleware. Note: X-XSS-Protection is deprecated in modern browsers; rely on a strong Content Security Policy (CSP) instead:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="config/http.yaml"',children:'security:\n  headers:\n    X-Content-Type-Options: nosniff\n    X-Frame-Options: DENY\n    Strict-Transport-Security: "max-age=31536000; includeSubDomains"\n    Content-Security-Policy: "default-src \'self\'"\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"routed.security"})," validates this section and inserts the corresponding middleware automatically. Use ",(0,s.jsx)(n.code,{children:"dart run routed_cli provider:list --config"})," to review the active headers and spot malformed values before starting the server."]}),"\n",(0,s.jsx)(n.h2,{id:"content-negotiation",children:"Content Negotiation"}),"\n",(0,s.jsx)(n.p,{children:"Accept headers often include multiple types and weights (q-values). The example below is simplified; in production, prefer robust parsing or default to JSON sensibly."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"router.get('/data', (ctx) {\n  final acceptHeader = ctx.requestHeader('Accept');\n  \n  switch (acceptHeader) {\n    case 'application/json':\n      return ctx.json({'data': 'content'});\n    case 'application/xml':\n      return ctx.xml({'data': 'content'});\n    case 'text/plain':\n      return ctx.string('content');\n    default:\n      return ctx.json({'data': 'content'}); // default to JSON\n  }\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"custom-headers",children:"Custom Headers"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"router.group(\n  middlewares: [\n    (ctx, next) async {\n      ctx.setHeader('X-Request-ID', ctx.request.id);\n      final started = DateTime.now();\n\n      final response = await next();\n\n      final duration = DateTime.now().difference(started).inMilliseconds;\n      ctx.setHeader('X-Response-Time', '${duration}ms');\n\n      return response;\n    }\n  ],\n  builder: (router) {\n    // Routes with tracking headers...\n  }\n);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"header-middleware",children:"Header Middleware"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"Future<Response> headerMiddleware(EngineContext ctx, Next next) async {\n  // Validate required headers\n  final apiKey = ctx.requestHeader('X-API-Key');\n  if (apiKey == null) {\n    return ctx.json({\n      'error': 'Missing API key'\n    }, statusCode: 401);\n  }\n  \n  // Add standard headers\n  ctx.setHeader('X-Powered-By', 'Routed');\n  ctx.setHeader('X-Version', '1.0.0');\n  \n  final response = await next();\n\n  // Add post-processing headers\n  ctx.setHeader('X-Processed-By', 'MyApp');\n  return response;\n}\n"})})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>i});var r=t(6540);const s={},a=r.createContext(s);function d(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);