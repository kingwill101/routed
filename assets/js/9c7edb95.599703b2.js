"use strict";(self.webpackChunkrouted=self.webpackChunkrouted||[]).push([[943],{6475:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>o,contentTitle:()=>a,default:()=>d,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"server-testing/test-client/ephemeral-server","title":"Ephemeral server","description":"Using TestClient.ephemeralServer with real browsers","source":"@site/docs/server-testing/test-client/ephemeral-server.mdx","sourceDirName":"server-testing/test-client","slug":"/server-testing/test-client/ephemeral-server","permalink":"/docs/server-testing/test-client/ephemeral-server","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/server-testing/test-client/ephemeral-server.mdx","tags":[],"version":"current","frontMatter":{"title":"Ephemeral server","description":"Using TestClient.ephemeralServer with real browsers"},"sidebar":"tutorialSidebar","previous":{"title":"Numeric Extensions","permalink":"/docs/server-testing/test-client/numeric-extensions"},"next":{"title":"Browser Testing","permalink":"/docs/server-testing/browser/browser-testing"}}');var n=t(4848),i=t(8453);const l={title:"Ephemeral server",description:"Using TestClient.ephemeralServer with real browsers"},a="Ephemeral server",o={},c=[];function p(e){const r={code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"ephemeral-server",children:"Ephemeral server"})}),"\n",(0,n.jsx)(r.p,{children:"Use TestClient.ephemeralServer with a handler provider (e.g., server_testing_shelf) to spin up a real HTTP server per test group."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-dart",children:"final handler = ShelfRequestHandler(app);\nfinal client = TestClient.ephemeralServer(handler);\nfinal baseUrl = await client.baseUrlFuture;\n\nbrowserGroup('e2e', baseUrl: baseUrl, define: (getBrowser) {\n  test('home', () async {\n    final browser = getBrowser();\n    await browser.visit('/');\n    await browser.assertTitle('Home');\n  });\n  tearDownAll(() async { await client.close(); });\n});\n"})}),"\n",(0,n.jsx)(r.p,{children:"Lifecycle"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Create client before browserGroup, await baseUrlFuture, and pass baseUrl."}),"\n",(0,n.jsx)(r.li,{children:"Always close the client in tearDownAll."}),"\n"]})]})}function d(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},8453:(e,r,t)=>{t.d(r,{R:()=>l,x:()=>a});var s=t(6540);const n={},i=s.createContext(n);function l(e){const r=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);