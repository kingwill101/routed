"use strict";(self.webpackChunkrouted=self.webpackChunkrouted||[]).push([[872],{8413:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>d,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"server-testing/test-client/test-response","title":"TestResponse","description":"Fluent assertions for status, headers, body, and JSON payloads","source":"@site/docs/server-testing/test-client/test-response.mdx","sourceDirName":"server-testing/test-client","slug":"/server-testing/test-client/test-response","permalink":"/docs/server-testing/test-client/test-response","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/server-testing/test-client/test-response.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"TestResponse","description":"Fluent assertions for status, headers, body, and JSON payloads","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"TestClient","permalink":"/docs/server-testing/test-client"},"next":{"title":"Response Assertions","permalink":"/docs/server-testing/test-client/response-assertions"}}');var r=n(4848),i=n(8453);const d={title:"TestResponse",description:"Fluent assertions for status, headers, body, and JSON payloads",sidebar_position:2},o="TestResponse",l={},a=[{value:"Status Assertions",id:"status-assertions",level:2},{value:"Header Helpers",id:"header-helpers",level:2},{value:"Body Assertions",id:"body-assertions",level:2},{value:"JSON Utilities",id:"json-utilities",level:2},{value:"Debugging Helpers",id:"debugging-helpers",level:2}];function c(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"testresponse",children:"TestResponse"})}),"\n",(0,r.jsxs)(s.p,{children:["All ",(0,r.jsx)(s.code,{children:"TestClient"})," methods return a ",(0,r.jsx)(s.code,{children:"TestResponse"}),". The object contains the raw status, headers, and body as well as a lazily-parsed JSON representation when the ",(0,r.jsx)(s.code,{children:"content-type"})," header contains ",(0,r.jsx)(s.code,{children:"application/json"}),"."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-dart",children:"final response = await client.getJson('/users/1');\nresponse\n  .assertSuccess()\n  .assertHeaderContains('content-type', 'application/json')\n  .assertJsonPath('id', 1);\n"})}),"\n",(0,r.jsx)(s.h2,{id:"status-assertions",children:"Status Assertions"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"assertStatus(int expected)"})}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"assertSuccess()"})," \u2014 200 \u2264 status < 300"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"assertClientError()"})," \u2014 400 \u2264 status < 500"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"assertServerError()"})," \u2014 500 \u2264 status < 600"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"header-helpers",children:"Header Helpers"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"assertHasHeaders()"})," / ",(0,r.jsx)(s.code,{children:"assertNoHeaders()"})]}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"assertHasHeader(String key)"})}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"assertHeader(String key, String value)"})," \u2014 equality match"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"assertHeaderContains(String key, dynamic value)"})," \u2014 substring or collection contains"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"assertContentType(String mime)"})," \u2014 shorthand for the common case"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"header(String key)"})," \u2014 retrieve the raw header list (also triggers ",(0,r.jsx)(s.code,{children:"assertHasHeader"}),")"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"body-assertions",children:"Body Assertions"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"assertBody(String expected)"})," and ",(0,r.jsx)(s.code,{children:"assertBodyEquals(String expected)"})]}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"assertBodyContains(String substring)"})}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"assertBodyIsEmpty()"})," / ",(0,r.jsx)(s.code,{children:"assertBodyIsNotEmpty()"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"assertNoBody()"})," when an empty response is expected"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"json-utilities",children:"JSON Utilities"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"json()"})," returns the decoded payload (throws if content-type is not JSON)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"json(path)"})," drills into dot-delimited keys (",(0,r.jsx)(s.code,{children:"'user.profile.name'"}),")"]}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"assertJsonPath(String path, dynamic expected)"})}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"assertJson(AssertableJsonCallback callback)"})," leverages the ",(0,r.jsx)(s.code,{children:"assertable_json"})," DSL (",(0,r.jsx)(s.code,{children:"json.has('items').count('items', 2)"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"assertJsonContains(Map<String, dynamic> partial)"})," for partial map comparisons"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"assertJsonFilesContain(String key, String filename)"})," convenience helper for list-of-files structures"]}),"\n"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"assertJson"})," and the fluent DSL ship from the ",(0,r.jsx)(s.a,{href:"https://pub.dev/packages/assertable_json",children:(0,r.jsx)(s.code,{children:"assertable_json"})})," package, which ",(0,r.jsx)(s.code,{children:"server_testing"})," re-exports for convenience. Importing ",(0,r.jsx)(s.code,{children:"package:server_testing/server_testing.dart"})," gives you the assertion API without adding another dependency."]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"debugging-helpers",children:"Debugging Helpers"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"dump()"})," prints the URI, status line, headers, and body in an HTTP-like format\u2014handy when a test fails unexpectedly."]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Because the assertions return ",(0,r.jsx)(s.code,{children:"this"}),", they are chainable. Combine them to keep tests readable:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-dart",children:"final login = await client.postJson('/login', {\n  'email': 'a@b.test',\n  'password': 'secret',\n});\nlogin\n  ..assertStatus(200)\n  ..assertJsonContains({'token': 'abc123'});\n"})})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>d,x:()=>o});var t=n(6540);const r={},i=t.createContext(r);function d(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);