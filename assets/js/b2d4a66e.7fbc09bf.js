"use strict";(self.webpackChunkrouted=self.webpackChunkrouted||[]).push([[2421],{491:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"assertable json/json-string-testing","title":"JSON String Testing","description":"Learn about testing JSON string responses with assertable_json","source":"@site/docs/assertable json/json-string-testing.mdx","sourceDirName":"assertable json","slug":"/assertable json/json-string-testing","permalink":"/docs/assertable json/json-string-testing","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/assertable json/json-string-testing.mdx","tags":[],"version":"current","frontMatter":{"title":"JSON String Testing","description":"Learn about testing JSON string responses with assertable_json"},"sidebar":"tutorialSidebar","previous":{"title":"Debugging Tools","permalink":"/docs/assertable json/debugging-tools"},"next":{"title":"Numeric Assertions","permalink":"/docs/assertable json/numeric-assertions"}}');var a=s(4848),r=s(8453);const i={title:"JSON String Testing",description:"Learn about testing JSON string responses with assertable_json"},o="JSON String Testing",l={},c=[{value:"Introduction to AssertableJsonString",id:"introduction-to-assertablejsonstring",level:2},{value:"Basic Assertions",id:"basic-assertions",level:2},{value:"Count Assertions",id:"count-assertions",level:3},{value:"Structure Validation",id:"structure-validation",level:3},{value:"Fragment Validation",id:"fragment-validation",level:3},{value:"Exact Matching",id:"exact-matching",level:3},{value:"Accessing Nested Data",id:"accessing-nested-data",level:2},{value:"Combining with AssertableJson",id:"combining-with-assertablejson",level:2},{value:"Testing API Responses",id:"testing-api-responses",level:2},{value:"Handling Arrays",id:"handling-arrays",level:2},{value:"Complete Example",id:"complete-example",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"json-string-testing",children:"JSON String Testing"})}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"assertable_json"})," package provides the ",(0,a.jsx)(n.code,{children:"AssertableJsonString"})," class specifically designed for testing JSON data that comes in string format, such as API responses."]}),"\n",(0,a.jsx)(n.h2,{id:"introduction-to-assertablejsonstring",children:"Introduction to AssertableJsonString"}),"\n",(0,a.jsxs)(n.p,{children:["While ",(0,a.jsx)(n.code,{children:"AssertableJson"})," works with already parsed JSON objects, ",(0,a.jsx)(n.code,{children:"AssertableJsonString"})," accepts JSON string input and provides additional methods for testing it:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:'// Create from JSON string\nfinal jsonResponse = AssertableJsonString(\'{"status":"success","data":{"id":123}}\');\n\n// Or from an object (it will be converted to a string)\nfinal jsonResponse = AssertableJsonString({\n  "status": "success",\n  "data": {"id": 123}\n});\n'})}),"\n",(0,a.jsx)(n.h2,{id:"basic-assertions",children:"Basic Assertions"}),"\n",(0,a.jsx)(n.h3,{id:"count-assertions",children:"Count Assertions"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"jsonResponse\n  // Check root element count\n  .assertCount(2)  // Has 2 root properties: 'status' and 'data'\n  \n  // Check count within a path\n  .assertCount(1, 'data');  // 'data' has 1 property\n"})}),"\n",(0,a.jsx)(n.h3,{id:"structure-validation",children:"Structure Validation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"jsonResponse.assertStructure({\n  'status': null,  // Just check existence\n  'data': {\n    'id': null,    // Just check existence\n    'user': {\n      'name': null,\n      'email': null\n    }\n  }\n});\n"})}),"\n",(0,a.jsx)(n.h3,{id:"fragment-validation",children:"Fragment Validation"}),"\n",(0,a.jsx)(n.p,{children:"Check if the JSON contains specific data fragments:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"jsonResponse.assertFragment({\n  'status': 'success'\n});\n\n// Deeper fragments\njsonResponse.assertFragment({\n  'data': {\n    'id': 123\n  }\n});\n"})}),"\n",(0,a.jsx)(n.h3,{id:"exact-matching",children:"Exact Matching"}),"\n",(0,a.jsx)(n.p,{children:"Validate that the JSON matches exactly with the provided data:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"jsonResponse.assertExact({\n  'status': 'success',\n  'data': {\n    'id': 123\n  }\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"accessing-nested-data",children:"Accessing Nested Data"}),"\n",(0,a.jsx)(n.p,{children:"Use JSON path notation to retrieve nested values:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"final userId = jsonResponse.jsonPath('data.id');\nexpect(userId, equals(123));\n\nfinal status = jsonResponse.jsonPath('status');\nexpect(status, equals('success'));\n"})}),"\n",(0,a.jsx)(n.h2,{id:"combining-with-assertablejson",children:"Combining with AssertableJson"}),"\n",(0,a.jsxs)(n.p,{children:["You can combine ",(0,a.jsx)(n.code,{children:"AssertableJsonString"})," with ",(0,a.jsx)(n.code,{children:"AssertableJson"})," for more comprehensive testing:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"// First validate basic structure \nfinal jsonResponse = AssertableJsonString(responseString)\n  .assertCount(3)\n  .assertStructure({\n    'status': null,\n    'data': {\n      'users': {\n        '*': ['id', 'name']  // All array items have these fields\n      }\n    },\n    'meta': null\n  });\n\n// Then use AssertableJson for detailed assertions\nfinal json = AssertableJson(jsonResponse.decoded);\n\njson\n  .where('status', 'success')\n  .scope('data.users', (users) {\n    users.each((user) {\n      user\n        .whereType<int>('id')\n        .whereType<String>('name');\n    });\n  });\n"})}),"\n",(0,a.jsx)(n.h2,{id:"testing-api-responses",children:"Testing API Responses"}),"\n",(0,a.jsx)(n.p,{children:"A common use case is testing HTTP API responses:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"test('API returns expected user data', () async {\n  // Make the API call\n  final response = await httpClient.get('/api/users/1');\n  \n  // Create AssertableJsonString from response body\n  final jsonResponse = AssertableJsonString(response.body);\n  \n  // Test the response structure and content\n  jsonResponse\n    .assertCount(2)\n    .assertStructure({\n      'status': null,\n      'data': {\n        'user': {\n          'id': null,\n          'name': null,\n          'email': null\n        }\n      }\n    })\n    .assertFragment({\n      'status': 'success'\n    });\n  \n  // Get the decoded data for further testing\n  final userData = jsonResponse.jsonPath('data.user');\n  expect(userData['id'], equals(1));\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"handling-arrays",children:"Handling Arrays"}),"\n",(0,a.jsx)(n.p,{children:"Testing arrays in JSON strings:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"test('API returns list of products', () async {\n  final jsonResponse = AssertableJsonString('''\n  {\n    \"status\": \"success\",\n    \"products\": [\n      {\"id\": 1, \"name\": \"Product 1\", \"price\": 29.99},\n      {\"id\": 2, \"name\": \"Product 2\", \"price\": 49.99},\n      {\"id\": 3, \"name\": \"Product 3\", \"price\": 19.99}\n    ],\n    \"count\": 3\n  }\n  ''');\n  \n  // Check structure and count\n  jsonResponse\n    .assertCount(3)  // 3 root properties\n    .assertStructure({\n      'status': null,\n      'products': {\n        '*': ['id', 'name', 'price']  // Each product has these fields\n      },\n      'count': null\n    });\n  \n  // Check fragment\n  jsonResponse.assertFragment({\n    'status': 'success',\n    'count': 3\n  });\n  \n  // Access array for more detailed testing\n  final products = jsonResponse.jsonPath('products') as List;\n  expect(products.length, equals(3));\n  expect(products[0]['name'], equals('Product 1'));\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"test('complete JSON string testing example', () {\n  final jsonStr = '''\n  {\n    \"status\": \"success\",\n    \"data\": {\n      \"user\": {\n        \"id\": 123,\n        \"name\": \"John Doe\",\n        \"email\": \"john@example.com\",\n        \"isActive\": true,\n        \"roles\": [\"admin\", \"user\"]\n      },\n      \"permissions\": {\n        \"read\": true,\n        \"write\": true,\n        \"delete\": false\n      }\n    },\n    \"meta\": {\n      \"timestamp\": 1609459200,\n      \"version\": \"1.0\"\n    }\n  }\n  ''';\n\n  final response = AssertableJsonString(jsonStr);\n  \n  // Basic structure validation\n  response\n    .assertCount(3)  // 3 root properties\n    .assertStructure({\n      'status': null,\n      'data': {\n        'user': {\n          'id': null,\n          'name': null,\n          'email': null,\n          'isActive': null,\n          'roles': null\n        },\n        'permissions': {\n          'read': null,\n          'write': null,\n          'delete': null\n        }\n      },\n      'meta': {\n        'timestamp': null,\n        'version': null\n      }\n    });\n  \n  // Fragment testing\n  response\n    .assertFragment({\n      'status': 'success',\n      'data': {\n        'user': {\n          'id': 123,\n          'name': 'John Doe'\n        }\n      }\n    });\n  \n  // More detailed testing with AssertableJson\n  final json = AssertableJson(response.decoded);\n  \n  json\n    .where('status', 'success')\n    \n    .scope('data.user', (user) {\n      user\n        .whereType<int>('id')\n        .whereType<String>('name')\n        .whereType<String>('email')\n        .whereContains('email', '@')\n        .whereType<bool>('isActive')\n        .where('isActive', true)\n        .whereType<List>('roles')\n        .count('roles', 2);\n    })\n    \n    .scope('data.permissions', (permissions) {\n      permissions\n        .whereType<bool>('read')\n        .whereType<bool>('write')\n        .whereType<bool>('delete')\n        .where('read', true)\n        .where('write', true)\n        .where('delete', false);\n    })\n    \n    .scope('meta', (meta) {\n      meta\n        .whereType<int>('timestamp')\n        .whereType<String>('version')\n        .where('version', '1.0');\n    });\n});\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>o});var t=s(6540);const a={},r=t.createContext(a);function i(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);