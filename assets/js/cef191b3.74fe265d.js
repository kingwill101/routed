"use strict";(self.webpackChunkrouted=self.webpackChunkrouted||[]).push([[3783],{1308:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"routed/fundamentals/cookies","title":"Cookies","description":"Set, read, and secure cookies in Routed","source":"@site/docs/routed/fundamentals/cookies.mdx","sourceDirName":"routed/fundamentals","slug":"/routed/fundamentals/cookies","permalink":"/docs/routed/fundamentals/cookies","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/routed/fundamentals/cookies.mdx","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"title":"Cookies","description":"Set, read, and secure cookies in Routed","sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"Headers","permalink":"/docs/routed/fundamentals/headers"},"next":{"title":"Fallback precedence","permalink":"/docs/routed/fundamentals/fallback-precedence"}}');var i=o(4848),s=o(8453);const a={title:"Cookies",description:"Set, read, and secure cookies in Routed",sidebar_position:7},r=void 0,c={},d=[{value:"Setting Cookies",id:"setting-cookies",level:2},{value:"Reading Cookies",id:"reading-cookies",level:2},{value:"Deleting Cookies",id:"deleting-cookies",level:2},{value:"Cookie Security",id:"cookie-security",level:2},{value:"Secure Cookies and SameSite",id:"secure-cookies-and-samesite",level:3},{value:"Domain and Path Restrictions",id:"domain-and-path-restrictions",level:3},{value:"Common Use Cases",id:"common-use-cases",level:2},{value:"Remember Me",id:"remember-me",level:3},{value:"User Preferences",id:"user-preferences",level:3},{value:"Cookie Middleware",id:"cookie-middleware",level:2}];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Routed provides helpers to set, read, and delete HTTP cookies. For authenticated state or flash data, prefer ",(0,i.jsx)(n.a,{href:"/docs/routed/state/sessions",children:"Sessions"})," and review ",(0,i.jsx)(n.a,{href:"/docs/routed/security",children:"Security"})," to choose safe defaults."]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Import ",(0,i.jsx)(n.code,{children:"dart:io"})," to access the ",(0,i.jsx)(n.code,{children:"SameSite"})," enum used in the examples below."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"setting-cookies",children:"Setting Cookies"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"router.get('/preferences', (ctx) {\n  // Basic cookie\n  ctx.setCookie('theme', 'dark');\n  \n  // Cookie with options\n  ctx.setCookie(\n    'session', \n    'abc123',\n    maxAge: 3600,          // 1 hour\n    path: '/',             // Available on all paths\n    domain: 'example.com', // Domain scope\n    secure: true,          // HTTPS only\n    httpOnly: true,        // No JavaScript access\n    sameSite: SameSite.strict\n  );\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"reading-cookies",children:"Reading Cookies"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"router.get('/user', (ctx) {\n  // Get specific cookie\n  final sessionCookie = ctx.cookie('session');\n  if (sessionCookie != null) {\n    print('Value: ${sessionCookie.value}');\n    print('Domain: ${sessionCookie.domain}');\n    print('Expires: ${sessionCookie.expires}');\n  }\n  \n  // Access all cookies\n  ctx.request.cookies.forEach((cookie) {\n    print('${cookie.name}: ${cookie.value}');\n  });\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"deleting-cookies",children:"Deleting Cookies"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"router.get('/logout', (ctx) {\n  // Delete by setting empty value and immediate expiration\n  ctx.setCookie(\n    'session', \n    '', \n    maxAge: 0,\n    path: '/'  // Path and domain must match how the cookie was set\n  );\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"cookie-security",children:"Cookie Security"}),"\n",(0,i.jsxs)(n.p,{children:["Use Secure, HttpOnly, and an appropriate SameSite policy (Lax, Strict, or None) to mitigate CSRF and cross-site data leaks. See ",(0,i.jsx)(n.a,{href:"/docs/routed/security",children:"Security"})," and ",(0,i.jsx)(n.a,{href:"/docs/routed/state/sessions",children:"Sessions"})," for guidance on choosing policies and storing sensitive state."]}),"\n",(0,i.jsx)(n.h3,{id:"secure-cookies-and-samesite",children:"Secure Cookies and SameSite"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"// HTTPS-only cookie\nctx.setCookie(\n  'auth_token',\n  token,\n  secure: true,    // Requires HTTPS\n  httpOnly: true,  // No JavaScript access\n  sameSite: SameSite.strict  // Strict same-site policy\n);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"domain-and-path-restrictions",children:"Domain and Path Restrictions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"// Subdomain cookie\nctx.setCookie(\n  'api_key',\n  key,\n  domain: 'api.example.com',\n  path: '/v1'\n);\n\n// Root domain cookie\nctx.setCookie(\n  'user_id',\n  id,\n  domain: 'example.com',\n  path: '/'\n);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"common-use-cases",children:"Common Use Cases"}),"\n",(0,i.jsx)(n.h3,{id:"remember-me",children:"Remember Me"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"router.post('/login', (ctx) async {\n  if (await authenticate(ctx)) {\n    // Set long-lived, opaque remember token (store and verify server-side)\n    ctx.setCookie(\n      'remember_token',\n      generateToken(),\n      maxAge: 30 * 24 * 3600,  // 30 days\n      secure: true,\n      httpOnly: true\n    );\n  }\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"user-preferences",children:"User Preferences"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"router.post('/settings', (ctx) async {\n  // Store user preferences\n  ctx.setCookie('theme', await ctx.postForm('theme'));\n  ctx.setCookie('language', await ctx.postForm('language'));\n  \n  // Store notifications preference with shorter lifetime\n  ctx.setCookie(\n    'notifications',\n    await ctx.postForm('notifications'),\n    maxAge: 7 * 24 * 3600  // 7 days\n  );\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"cookie-middleware",children:"Cookie Middleware"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"Future<Response> cookieMiddleware(EngineContext ctx, Next next) async {\n  // Check required cookie\n  final authCookie = ctx.cookie('auth');\n  if (authCookie == null) {\n    return ctx.json({\n      'error': 'Authentication required'\n    }, statusCode: 401);\n  }\n  \n  // Validate cookie (signature/expiry) and rotate tokens when appropriate\n  if (!isValidCookie(authCookie)) {\n    // Clear invalid cookie\n    ctx.setCookie('auth', '', maxAge: 0);\n    return ctx.json({\n      'error': 'Invalid authentication'\n    }, statusCode: 401);\n  }\n  \n  return await next();\n}\n\nrouter.group(\n  path: '/protected',\n  middlewares: [cookieMiddleware],\n  builder: (router) {\n    // Protected routes...\n  }\n);\n"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>a,x:()=>r});var t=o(6540);const i={},s=t.createContext(i);function a(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);