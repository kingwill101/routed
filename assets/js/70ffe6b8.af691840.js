"use strict";(globalThis.webpackChunkrouted=globalThis.webpackChunkrouted||[]).push([[1861],{7952:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"storage","title":"Storage","description":"Configure storage disks for static assets, views, and uploads","source":"@site/docs/routed/storage.mdx","sourceDirName":".","slug":"/storage","permalink":"/docs/routed/storage","draft":false,"unlisted":false,"editUrl":"https://github.com/kingwill101/routed/tree/main/docs/docs/routed/storage.mdx","tags":[],"version":"current","sidebarPosition":21,"frontMatter":{"title":"Storage","description":"Configure storage disks for static assets, views, and uploads","sidebar_position":21},"sidebar":"routedSidebar","previous":{"title":"Static Assets","permalink":"/docs/routed/static-assets"},"next":{"title":"Uploads","permalink":"/docs/routed/uploads"}}');var o=r(4848),n=r(8453);const a={title:"Storage",description:"Configure storage disks for static assets, views, and uploads",sidebar_position:21},i="Storage",d={},l=[{value:"Configuration",id:"configuration",level:2},{value:"Driver options",id:"driver-options",level:2},{value:"Storage base vs disk roots",id:"storage-base-vs-disk-roots",level:2},{value:"Helper paths",id:"helper-paths",level:2},{value:"StorageManager usage",id:"storagemanager-usage",level:2},{value:"Next steps",id:"next-steps",level:2}];function c(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.header,{children:(0,o.jsx)(s.h1,{id:"storage",children:"Storage"})}),"\n",(0,o.jsxs)(s.p,{children:["Storage disks provide the shared file abstraction for uploads, static mounts, and views. Configure disks once under ",(0,o.jsx)(s.code,{children:"storage.*"}),", then reference them in ",(0,o.jsx)(s.code,{children:"static.mounts"}),", ",(0,o.jsx)(s.code,{children:"view.disk"}),", or upload handlers."]}),"\n",(0,o.jsx)(s.h2,{id:"configuration",children:"Configuration"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-yaml",metastring:'title="config/storage.yaml"',children:'storage:\n  default: local\n  # Base used by storage helpers (cache/session/storage_path).\n  base: "{{ env.APP_ROOT }}/storage"\n  # Root used for the default local disk when not overridden.\n  root: storage/app\n  disks:\n    local:\n      driver: local\n      root: storage/app\n    assets:\n      driver: local\n      root: public\n    backups:\n      driver: s3\n      options:\n        endpoint: https://s3.amazonaws.com\n        bucket: my-app-assets\n        key: ${S3_KEY}\n        secret: ${S3_SECRET}\n        region: us-east-1\n'})}),"\n",(0,o.jsx)(s.h2,{id:"driver-options",children:"Driver options"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Local"}),": ",(0,o.jsx)(s.code,{children:"root"}),", optional ",(0,o.jsx)(s.code,{children:"file_system"})," (programmatic only)."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"S3/Cloud"}),": ",(0,o.jsx)(s.code,{children:"endpoint"}),", ",(0,o.jsx)(s.code,{children:"bucket"}),", ",(0,o.jsx)(s.code,{children:"key"}),", ",(0,o.jsx)(s.code,{children:"secret"}),", ",(0,o.jsx)(s.code,{children:"region"}),", optional ",(0,o.jsx)(s.code,{children:"prefix"}),", ",(0,o.jsx)(s.code,{children:"visibility"}),", ",(0,o.jsx)(s.code,{children:"url"}),", ",(0,o.jsx)(s.code,{children:"throw"}),", ",(0,o.jsx)(s.code,{children:"report"}),", ",(0,o.jsx)(s.code,{children:"directory_separator"}),"."]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"storage-base-vs-disk-roots",children:"Storage base vs disk roots"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"storage.base"})," anchors helper paths like ",(0,o.jsx)(s.code,{children:"storage_path()"})," and framework cache/session storage."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"storage.root"})," only seeds the default local disk if ",(0,o.jsx)(s.code,{children:"storage.disks.local.root"})," is missing."]}),"\n",(0,o.jsxs)(s.li,{children:["When ",(0,o.jsx)(s.code,{children:"app.root"})," is available, relative storage paths resolve against it."]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"helper-paths",children:"Helper paths"}),"\n",(0,o.jsxs)(s.p,{children:["Use the ",(0,o.jsx)(s.code,{children:"StorageDefaults"})," helper to build framework paths when you need absolute locations:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-dart",children:"final defaults = await engine.make<StorageDefaults>();\nfinal cachePath = defaults.frameworkPath('cache');\n"})}),"\n",(0,o.jsx)(s.h2,{id:"storagemanager-usage",children:"StorageManager usage"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-dart",children:"final storage = await engine.make<StorageManager>();\nfinal logoPath = storage.resolve('logo.png', disk: 'assets');\n"})}),"\n",(0,o.jsx)(s.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:(0,o.jsx)(s.a,{href:"/docs/routed/fundamentals/configuration#storage-disks",children:"Configuration: Storage"})}),"\n",(0,o.jsx)(s.li,{children:(0,o.jsx)(s.a,{href:"/docs/routed/views/",children:"Views & Templates"})}),"\n",(0,o.jsx)(s.li,{children:(0,o.jsx)(s.a,{href:"/docs/routed/static-assets",children:"Static Assets"})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,s,r)=>{r.d(s,{R:()=>a,x:()=>i});var t=r(6540);const o={},n=t.createContext(o);function a(e){const s=t.useContext(n);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),t.createElement(n.Provider,{value:s},e.children)}}}]);