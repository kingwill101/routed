---
title: Routed Inertia
description: Inertia.js middleware, SSR, and assets for Routed apps
sidebar_position: 0
---

# Routed Inertia

Routed Inertia wires Inertia.js into Routed with middleware, `EngineContext`
helpers, and SSR support so you can serve SPA-like pages from a Dart backend.

> **New to Inertia?** Follow the [Build a Todo App](/docs/routed_inertia/tutorial) tutorial for a hands-on walkthrough.

## Features

- `ctx.inertia` response helpers for JSON + HTML payloads.
- Shared props, flash messages, and error bags.
- Config-driven SSR, asset manifests, and Vite hot reload support.
- Testing helpers for Inertia responses.

## Install

```bash
dart pub add routed_inertia
```

`routed_inertia` re-exports the core server helpers from
`package:inertia_dart/inertia_dart.dart`, so you can keep a single import in
most apps. The inertia_dart package provides the Inertia protocol helpers,
asset manifest reader, SSR gateways, and middleware used under the hood.

## Start a project

1) Scaffold a Routed app with Inertia support:

```bash
dart run routed create --name inertia_app --inertia
cd inertia_app
```

This generates the full project structure including server configs, a Liquid
template, and a Vite + React client under `client/`. You can also pass
`--inertia-framework vue` or `--inertia-framework svelte` for a different
frontend framework.

2) Add Inertia server dependencies:

```bash
dart pub add routed_inertia
```

3) Scaffold the frontend with the inertia_dart CLI (recommended):

```bash
dart run inertia_dart:inertia create client --framework react --package-manager npm
```

If you already have a Vite project, run:

```bash
dart run inertia_dart:inertia install --framework react --package-manager npm --path client
```

4) Add a frontend client manually (optional):

```bash
mkdir client
cd client
npm init -y
npm install @inertiajs/core @inertiajs/react react react-dom
npm install -D vite @vitejs/plugin-react
```

5) Configure the server to read Inertia settings:

```yaml
# config/http.yaml
providers:
  - routed.inertia
```

```yaml
# config/inertia.yaml
version: "1.0.0"
root_view: "inertia/app"
assets:
  manifest_path: "client/dist/.vite/manifest.json"
  entry: "index.html"
  base_url: "/"
  hot_file: "client/public/hot"
```

6) Run dev servers:

```bash
# client
npm run dev

# server (from app root)
dart run routed dev
```

7) Configure static asset serving for production:

Vite builds hashed assets into `client/dist/assets/`. You need a storage disk
and a static mount so Routed can serve them:

```yaml
# config/storage.yaml
default: local
disks:
  local:
    driver: local
    root: "storage/app"
  public:
    driver: local
    root: "."
```

```yaml
# config/static.yaml
enabled: true
mounts:
  - route: /assets
    disk: public
    path: client/dist/assets
```

Without the `public` disk, paths resolve relative to the default disk root
(`storage/app`), causing 404s for static assets. See the
[tutorial](/docs/routed_inertia/tutorial#assets-return-404-in-production)
for more details.

The example app in `packages/routed_inertia/example` includes a working Vite
setup, hot file wiring, and server integration if you want a full reference.

To manage the SSR worker, use the CLI commands:

```bash
dart run inertia_dart:inertia ssr:start
dart run inertia_dart:inertia ssr:check
dart run inertia_dart:inertia ssr:stop
```

## Quick start

```dart
import 'package:routed/routed.dart';
import 'package:routed_inertia/routed_inertia.dart';

final engine = Engine(
  options: [
    withMiddleware([
      RoutedInertiaMiddleware(versionResolver: () => '1.0.0').call,
    ]),
  ],
);

engine.get('/dashboard', (ctx) {
  return ctx.inertia(
    'Dashboard',
    props: {'user': {'name': 'Ada'}},
  );
});
```

## Provider + config setup

Register the provider and enable it in `http.yaml`.

```dart
import 'package:routed/routed.dart';
import 'package:routed_inertia/routed_inertia.dart';

registerRoutedInertiaProvider(ProviderRegistry.instance);
```

```yaml
# config/http.yaml
providers:
  - routed.inertia
```

```yaml
# config/inertia.yaml
version: "1.0.0"
root_view: "inertia/app"
history:
  encrypt: false
ssr:
  enabled: false
  url: "http://127.0.0.1:13714"
assets:
  manifest_path: "client/dist/.vite/manifest.json"
  entry: "index.html"
  base_url: "/"
  hot_file: "client/public/hot"
```

If you need a custom version resolver, register the provider directly:

```dart
final engine = Engine(
  providers: [
    CoreServiceProvider.withLoader(
      ConfigLoader.yaml(configDirectory: 'config'),
    ),
    InertiaServiceProvider(versionResolver: () => '1.0.0'),
  ],
);
```

## Shared props + errors

```dart
engine.get('/shared', (ctx) {
  ctx.inertiaShare({'appName': 'Routed'});
  return ctx.inertia('Shared', props: {'user': 'Ada'});
});

engine.post('/save', (ctx) {
  ctx.inertiaFlash('notice', 'Saved');
  ctx.inertiaErrors({'email': 'Required'});
  return ctx.redirect('/form');
});
```

Select error bags with `X-Inertia-Error-Bag` from the client.

## SSR + templates

```dart
engine.get('/', (ctx) {
  return ctx.inertia(
    'Home',
    props: {'title': 'Hello'},
    templateName: 'inertia/app',
    ssrEnabled: true,
    ssrGateway: HttpSsrGateway(Uri.parse('http://localhost:13714')),
  );
});
```

## Asset manifest helper

```dart
final manifest = await InertiaAssetManifest.load('client/dist/.vite/manifest.json');
final tags = manifest.renderTags('index.html', baseUrl: '/');
```

Inject the tags in your template or HTML builder.

## Testing

```dart
response.assertInertia((page) {
  page.component('Dashboard').has('user.name');
});
```

## Example app

See `packages/routed_inertia/example/README.md` for a full React + Routed demo.
