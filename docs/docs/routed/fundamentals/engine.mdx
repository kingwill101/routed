---
title: Engine Lifecycle
description: Understand bare vs full boot profiles, when to call initialize, and how Engine.full differs from Engine().
sidebar_position: 2
---

# Engine Lifecycle

The `Engine` owns the container, service providers, middleware stacks, and HTTP
servers. Routed now supports **two boot profiles**:

- **Bare** (default): minimal routing + middleware, no config loader, no provider manifest.
- **Full**: config loading + provider registration + manifest discovery (the previous default).

Use the profile that matches your workload, especially for benchmarks and tiny
services.

## `Engine()` – bare by default

Calling `Engine()` returns a bare-bones instance. No config files are loaded and
no providers are auto-registered. You are responsible for any providers you want
to boot.

```dart title="Bare engine"
final engine = Engine();
engine.get('/ping', (ctx) => ctx.text('pong'));

await engine.serve(address: '127.0.0.1', port: 8080);
```

**What you still get in bare mode**
- Route matching (including parameter patterns)
- Middleware execution
- The standard request/response helpers

**What you do NOT get by default**
- Config loader / `.env` processing
- Provider manifest discovery (`http.providers`)
- Built-in providers (logging, cache, sessions, etc.)

If you need those, use full mode.

## `Engine.full()` – explicit full mode

`Engine.full()` preserves the previous behavior: built-in providers are
registered, config defaults are merged, and the provider manifest is eligible
for loading.

```dart title="Full mode constructor"
final engine = Engine.full(
  configOptions: ConfigLoaderOptions(
    configDirectory: 'config',
    watch: true,
  ),
  options: [
    withTrustedProxies(['127.0.0.1']),
  ],
);

await engine.initialize();
```

## `Engine.create()` vs `Engine.createFull()`

`Engine.create()` is still the async convenience helper, but it now defaults to
**bare mode**:

```dart
final engine = await Engine.create(); // bare + initialized
```

If you want the full boot sequence (config + providers), use
`Engine.createFull()`:

```dart
final engine = await Engine.createFull(); // full + initialized
```

## Choosing between them

| Scenario | Recommended API | Notes |
| --- | --- | --- |
| Microbenchmarks / tiny services | `Engine()` or `Engine.create()` | Bare by default. Minimal overhead. |
| Integration / production boot | `Engine.full()` or `Engine.createFull()` | Config + providers boot automatically. |
| Unit tests that need providers | `Engine.full()` + `initialize()` | Matches previous defaults. |
| Custom registry seeding before built-ins | `Engine.full(options: [...])` | Options run immediately after construction. |

## Notes for config-driven features

Most `EngineOpt` helpers and provider-backed features depend on `Config`. In
bare mode, `Config` is not bound unless you register `CoreServiceProvider` or
bind a `Config` instance yourself. If you need config-driven middleware or
provider defaults, switch to full mode.
